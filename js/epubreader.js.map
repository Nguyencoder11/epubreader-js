{"version":3,"file":"js/epubreader.min.js","mappings":"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","sources":["webpack://epubjs-reader/./node_modules/d/index.js","webpack://epubjs-reader/./node_modules/es5-ext/function/noop.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/index.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/shim.js","webpack://epubjs-reader/./node_modules/es5-ext/object/is-value.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/index.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/shim.js","webpack://epubjs-reader/./node_modules/es5-ext/object/normalize-options.js","webpack://epubjs-reader/./node_modules/es5-ext/object/valid-callable.js","webpack://epubjs-reader/./node_modules/es5-ext/object/valid-value.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/index.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/shim.js","webpack://epubjs-reader/./node_modules/event-emitter/index.js","webpack://epubjs-reader/./node_modules/type/function/is.js","webpack://epubjs-reader/./node_modules/type/object/is.js","webpack://epubjs-reader/./node_modules/type/plain-function/is.js","webpack://epubjs-reader/./node_modules/type/prototype/is.js","webpack://epubjs-reader/./node_modules/type/value/is.js","webpack://epubjs-reader/webpack/bootstrap","webpack://epubjs-reader/webpack/runtime/compat get default export","webpack://epubjs-reader/webpack/runtime/define property getters","webpack://epubjs-reader/webpack/runtime/hasOwnProperty shorthand","webpack://epubjs-reader/./src/ui.js","webpack://epubjs-reader/./src/sidebar/metadata.js","webpack://epubjs-reader/./src/toolbar.js","webpack://epubjs-reader/./src/sidebar/toc.js","webpack://epubjs-reader/./src/sidebar/bookmarks.js","webpack://epubjs-reader/./src/sidebar/annotations.js","webpack://epubjs-reader/./src/sidebar/search.js","webpack://epubjs-reader/./src/sidebar/settings.js","webpack://epubjs-reader/./src/sidebar.js","webpack://epubjs-reader/./src/content.js","webpack://epubjs-reader/./src/strings.js","webpack://epubjs-reader/./src/reader.js","webpack://epubjs-reader/./src/storage.js","webpack://epubjs-reader/./src/main.js"],"sourcesContent":["\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * @author mrdoob https://github.com/mrdoob/ui.js\n */\n\nconst errormsg = 'is not an instance of UIElement.';\n\n/**\n * UIElement\n * @param {object} dom\n */\nclass UIElement {\n\n\tconstructor(dom) {\n\n\t\tthis.dom = dom;\n\t}\n\n\tadd() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.appendChild(argument.dom);\n\n\t\t\t} else if (Array.isArray(argument)) {\n\n\t\t\t\tfor (let j = 0; j < argument.length; j++) {\n\n\t\t\t\t\tconst element = argument[j];\n\n\t\t\t\t\tif (element instanceof UIElement) {\n\n\t\t\t\t\t\tthis.dom.appendChild(element.dom);\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.error('UIElement:', element, errormsg);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error('UIElement:', argument, errormsg);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tremove() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.removeChild(argument.dom);\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error('UIElement:', argument, errormsg);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclear() {\n\n\t\twhile (this.dom.children.length) {\n\n\t\t\tthis.dom.removeChild(this.dom.lastChild);\n\t\t}\n\t}\n\n\tsetId(id) {\n\n\t\tthis.dom.id = id;\n\t\treturn this;\n\t}\n\n\tgetId() {\n\n\t\treturn this.dom.id;\n\t}\n\n\tsetClass(name) {\n\n\t\tthis.dom.className = name;\n\t\treturn this;\n\t}\n\n\taddClass(name) {\n\n\t\tthis.dom.classList.add(name);\n\t\treturn this;\n\t}\n\n\tremoveClass(name) {\n\n\t\tthis.dom.classList.remove(name);\n\t\treturn this;\n\t}\n\n\tsetStyle(style, array) {\n\n\t\tfor (let i = 0; i < array.length; i++) {\n\n\t\t\tthis.dom.style[style] = array[i];\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetDisabled(value) {\n\n\t\tthis.dom.disabled = value;\n\t\treturn this;\n\t}\n\n\tsetTextContent(value) {\n\n\t\tthis.dom.textContent = value;\n\t\treturn this;\n\t}\n\n\tgetRect() {\n\n\t\tthis.dom.getBoundingClientRect();\n\t\treturn this;\n\t}\n}\n\n// properties\n\nconst properties = [\n\t'position',\n\t'left',\n\t'top',\n\t'right',\n\t'bottom',\n\t'width',\n\t'height',\n\t'border',\n\t'borderLeft',\n\t'borderTop',\n\t'borderRight',\n\t'borderBottom',\n\t'borderColor',\n\t'display',\n\t'overflow',\n\t'margin',\n\t'marginLeft',\n\t'marginTop',\n\t'marginRight',\n\t'marginBottom',\n\t'padding',\n\t'paddingLeft',\n\t'paddingTop',\n\t'paddingRight',\n\t'paddingBottom',\n\t'color',\n\t'background',\n\t'backgroundColor',\n\t'opacity',\n\t'fontSize',\n\t'fontWeight',\n\t'textAlign',\n\t'textDecoration',\n\t'textTransform',\n\t'cursor',\n\t'zIndex'\n];\n\nproperties.forEach(function (property) {\n\n\tconst method = 'set' +\n\t\tproperty.substr(0, 1).toUpperCase() +\n\t\tproperty.substr(1, property.length);\n\n\tUIElement.prototype[method] = function () {\n\n\t\tthis.setStyle(property, arguments);\n\n\t\treturn this;\n\t};\n});\n\n// events\n\nconst events = [\n\t'KeyUp',\n\t'KeyDown',\n\t'MouseOver',\n\t'MouseOut',\n\t'Click',\n\t'DblClick',\n\t'Change',\n\t'Input'\n];\n\nevents.forEach(function (event) {\n\n\tconst method = 'on' + event;\n\n\tUIElement.prototype[method] = function (callback) {\n\n\t\tthis.dom.addEventListener(event.toLowerCase(), callback.bind(this), false);\n\t\treturn this;\n\t};\n});\n\n/**\n * UISpan\n */\nclass UISpan extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('span'));\n\t}\n}\n\n/**\n * UIDiv\n */\nclass UIDiv extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('div'));\n\t}\n}\n\n/**\n * UIRow\n */\nclass UIRow extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\t\tthis.dom.className = 'row';\n\t}\n}\n\n/**\n * UIPanel\n */\nclass UIPanel extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\t\tthis.dom.className = 'panel';\n\t}\n}\n\nclass UILabel extends UIElement {\n\n\tconstructor(text, id) {\n\n\t\tsuper(document.createElement('label'));\n\t\tthis.dom.textContent = text;\n\t\tif (id) this.dom.htmlFor = id;\n\t}\n}\n\n/**\n * UIText\n * @param {any} text\n */\nclass UIText extends UISpan {\n\n\tconstructor(text) {\n\n\t\tsuper();\n\t\tthis.setValue(text);\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.textContent;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\n\t\t\tthis.dom.textContent = value;\n\t\t}\n\n\t\treturn this;\n\t}\n}\n\n/**\n * UILink\n * @param {*} uri\n * @param {*} label\n */\nclass UILink extends UIElement {\n\n\tconstructor(uri, label) {\n\n\t\tsuper(document.createElement('a'));\n\t\tthis.dom.href = uri;\n\t\tthis.dom.textContent = label;\n\t}\n}\n\n/**\n * UIInput\n * @param {any} value\n */\nclass UIInput extends UIElement {\n\n\tconstructor(type, value, title) {\n\n\t\tsuper(document.createElement('input'));\n\n\t\tthis.dom.type = type;\n\t\tthis.dom.addEventListener('keydown', function (event) {\n\n\t\t\tevent.stopPropagation();\n\n\t\t}, false);\n\n\t\tthis.setValue(value);\n\t\tthis.setTitle(title);\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tgetType() {\n\n\t\treturn this.dom.type;\n\t}\n\n\tsetType(type) {\n\n\t\tthis.dom.type = type;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\t\t\tthis.dom.value = value;\n\t\t}\n\t\treturn this;\n\t}\n\n\tgetTitle() {\n\n\t\treturn this.dom.title;\n\t}\n\n\tsetTitle(text) {\n\n\t\tif (text !== undefined) {\n\t\t\tthis.dom.title = text;\n\t\t}\n\t\treturn this;\n\t}\n\n\treadonly(value) {\n\n\t\tthis.dom.readOnly = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UITextArea\n */\nclass UITextArea extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('textarea'));\n\n\t\tthis.dom.spellcheck = false;\n\t\tthis.dom.addEventListener('keydown', function (event) {\n\n\t\t\tevent.stopPropagation();\n\n\t\t\tif (event.keyCode === 9) {\n\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tconst cursor = dom.selectionStart;\n\n\t\t\t\tthis.dom.value = this.dom.value.substring(0, cursor) + '\\t' + this.dom.value.substring(cursor);\n\t\t\t\tthis.dom.selectionStart = cursor + 1;\n\t\t\t\tthis.dom.selectionEnd = this.dom.selectionStart;\n\t\t\t}\n\n\t\t}, false);\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * The <select> element is used to create a drop-down list.\n */\nclass UISelect extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('select'));\n\t}\n\n\tsetMultiple(boolean) {\n\n\t\tthis.dom.multiple = boolean || false;\n\t\treturn this;\n\t}\n\n\tsetOptions(options) {\n\n\t\tconst selected = this.dom.value;\n\n\t\twhile (this.dom.children.length > 0) {\n\n\t\t\tthis.dom.removeChild(this.dom.firstChild);\n\t\t}\n\n\t\tfor (const key in options) {\n\n\t\t\tconst option = document.createElement('option');\n\t\t\toption.value = key;\n\t\t\toption.innerHTML = options[key];\n\t\t\tthis.dom.appendChild(option);\n\t\t}\n\n\t\tthis.dom.value = selected;\n\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tvalue = String(value);\n\n\t\tif (this.dom.value !== value) {\n\n\t\t\tthis.dom.value = value;\n\t\t}\n\n\t\treturn this;\n\t}\n}\n\n/**\n * UICheckbox\n * @param {boolean} value\n */\nclass UICheckbox extends UIElement {\n\n\tconstructor(value) {\n\n\t\tsuper(document.createElement('input'));\n\n\t\tthis.dom.type = 'checkbox';\n\t\tthis.setValue(value);\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.checked;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\n\t\t\tthis.dom.checked = value;\n\t\t}\n\t\treturn this;\n\t}\n}\n\n/**\n * UIColor\n */\nclass UIColor extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('input'));\n\n\t\ttry {\n\n\t\t\tthis.dom.type = 'color';\n\t\t\tthis.dom.value = '#ffffff';\n\n\t\t} catch (e) {\n\n\t\t\tconsole.exception(e);\n\t\t}\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tgetHexValue() {\n\n\t\treturn parseInt(this.dom.value.substr(1), 16);\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n\n\tsetHexValue(hex) {\n\n\t\tthis.dom.value = '#' + ('000000' + hex.toString(16)).slice(-6);\n\t\treturn this;\n\t}\n}\n\n/**\n * UINumber\n * @param {any} number\n */\nclass UINumber extends UIElement {\n\n\tconstructor(number) {\n\n\t\tsuper(document.createElement('input'));\n\n\n\t\tthis.dom.type = 'number';\n\t\tthis.dom.value = '0.00';\n\n\t\tthis.value = 0;\n\n\t\tthis.min = - Infinity;\n\t\tthis.max = + Infinity;\n\n\t\tthis.precision = 2;\n\t\tthis.step = 1;\n\t\tthis.unit = '';\n\t\tthis.nudge = 0.01;\n\n\t\tthis.setValue(number);\n\n\t\tconst scope = this;\n\n\t\tconst changeEvent = document.createEvent('HTMLEvents');\n\t\tchangeEvent.initEvent('change', true, true);\n\n\t\tlet distance = 0;\n\t\tlet onMouseDownValue = 0;\n\n\t\tconst pointer = { x: 0, y: 0 };\n\t\tconst prevPointer = { x: 0, y: 0 };\n\n\t\tfunction onMouseDown(event) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tdistance = 0;\n\n\t\t\tonMouseDownValue = scope.value;\n\n\t\t\tprevPointer.x = event.clientX;\n\t\t\tprevPointer.y = event.clientY;\n\n\t\t\tdocument.addEventListener('mousemove', onMouseMove, false);\n\t\t\tdocument.addEventListener('mouseup', onMouseUp, false);\n\t\t}\n\n\t\tfunction onMouseMove(event) {\n\n\t\t\tconst currentValue = scope.value;\n\n\t\t\tpointer.x = event.clientX;\n\t\t\tpointer.y = event.clientY;\n\n\t\t\tdistance += (pointer.x - prevPointer.x) - (pointer.y - prevPointer.y);\n\n\t\t\tlet value = onMouseDownValue + (distance / (event.shiftKey ? 5 : 50)) * scope.step;\n\t\t\tvalue = Math.min(scope.max, Math.max(scope.min, value));\n\n\t\t\tif (currentValue !== value) {\n\n\t\t\t\tscope.setValue(value);\n\t\t\t\tscope.dom.dispatchEvent(changeEvent);\n\t\t\t}\n\n\t\t\tprevPointer.x = event.clientX;\n\t\t\tprevPointer.y = event.clientY;\n\t\t}\n\n\t\tfunction onMouseUp() {\n\n\t\t\tdocument.removeEventListener('mousemove', onMouseMove, false);\n\t\t\tdocument.removeEventListener('mouseup', onMouseUp, false);\n\n\t\t\tif (Math.abs(distance) < 2) {\n\n\t\t\t\tscope.dom.focus();\n\t\t\t\tscope.dom.select();\n\t\t\t}\n\t\t}\n\n\t\tfunction onTouchStart(event) {\n\n\t\t\tif (event.touches.length === 1) {\n\n\t\t\t\tdistance = 0;\n\n\t\t\t\tonMouseDownValue = scope.value;\n\n\t\t\t\tprevPointer.x = event.touches[0].pageX;\n\t\t\t\tprevPointer.y = event.touches[0].pageY;\n\n\t\t\t\tdocument.addEventListener('touchmove', onTouchMove, false);\n\t\t\t\tdocument.addEventListener('touchend', onTouchEnd, false);\n\t\t\t}\n\t\t}\n\n\t\tfunction onTouchMove(event) {\n\n\t\t\tconst currentValue = scope.value;\n\n\t\t\tpointer.x = event.touches[0].pageX;\n\t\t\tpointer.y = event.touches[0].pageY;\n\n\t\t\tdistance += (pointer.x - prevPointer.x) - (pointer.y - prevPointer.y);\n\n\t\t\tlet value = onMouseDownValue + (distance / (event.shiftKey ? 5 : 50)) * scope.step;\n\t\t\tvalue = Math.min(scope.max, Math.max(scope.min, value));\n\n\t\t\tif (currentValue !== value) {\n\n\t\t\t\tscope.setValue(value);\n\t\t\t\tscope.dom.dispatchEvent(changeEvent);\n\t\t\t}\n\n\t\t\tprevPointer.x = event.touches[0].pageX;\n\t\t\tprevPointer.y = event.touches[0].pageY;\n\t\t}\n\n\t\tfunction onTouchEnd(event) {\n\n\t\t\tif (event.touches.length === 0) {\n\n\t\t\t\tdocument.removeEventListener('touchmove', onTouchMove, false);\n\t\t\t\tdocument.removeEventListener('touchend', onTouchEnd, false);\n\t\t\t}\n\t\t}\n\n\t\tfunction onChange() {\n\n\t\t\tscope.setValue(this.value);\n\t\t}\n\n\t\t//function onFocus() {\n\t\t//    dom.style.backgroundColor = '';\n\t\t//    dom.style.cursor = '';\n\t\t//}\n\t\t//function onBlur() {\n\t\t//    dom.style.backgroundColor = 'transparent';\n\t\t//    dom.style.cursor = 'ns-resize';\n\t\t//}\n\n\t\tfunction onKeyDown(event) {\n\n\t\t\tevent.stopPropagation();\n\n\t\t\tswitch (event.keyCode) {\n\n\t\t\t\t//case 13: // enter\n\t\t\t\t//    dom.blur();\n\t\t\t\t//    break;\n\t\t\t\tcase 38: // up\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tscope.setValue(scope.getValue() + scope.nudge);\n\t\t\t\t\tscope.dom.dispatchEvent(changeEvent);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 40: // down\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tscope.setValue(scope.getValue() - scope.nudge);\n\t\t\t\t\tscope.dom.dispatchEvent(changeEvent);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t//onBlur();\n\t\tthis.dom.addEventListener('keydown', onKeyDown, false);\n\t\tthis.dom.addEventListener('mousedown', onMouseDown, false);\n\t\tthis.dom.addEventListener('touchstart', onTouchStart, false);\n\t\tthis.dom.addEventListener('change', onChange, false);\n\t\t//dom.addEventListener('focus', onFocus, false);\n\t\t//dom.addEventListener('blur', onBlur, false);\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn parseFloat(this.dom.value);\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\n\t\t\tvalue = parseFloat(value);\n\n\t\t\tif (value < this.min)\n\t\t\t\tvalue = this.min;\n\t\t\tif (value > this.max)\n\t\t\t\tvalue = this.max;\n\n\t\t\tthis.value = value;\n\t\t\tthis.dom.value = value.toFixed(this.precision);\n\n\t\t\tif (this.unit !== '')\n\t\t\t\tthis.dom.value += ' ' + this.unit;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetPrecision(precision) {\n\n\t\tthis.precision = precision;\n\t\treturn this;\n\t}\n\n\tsetStep(step) {\n\n\t\tthis.step = step;\n\t\treturn this;\n\t}\n\n\tsetNudge(nudge) {\n\n\t\tthis.nudge = nudge;\n\t\treturn this;\n\t}\n\n\tsetRange(min, max) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t\treturn this;\n\t}\n\n\tsetUnit(unit) {\n\n\t\tthis.unit = unit;\n\t\treturn this;\n\t}\n\n\tsetTitle(text) {\n\n\t\tthis.dom.title = text;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIInteger\n * @param {number} value\n * @param {number} step\n * @param {number} min\n * @param {number} max\n */\nclass UIInteger extends UIElement {\n\n\tconstructor(value, step, min, max) {\n\n\t\tsuper(document.createElement('input'));\n\n\t\tthis.dom.type = 'number';\n\t\tthis.dom.value = value;\n\n\t\tif (step != undefined) {\n\t\t\tthis.dom.step = step;\n\t\t}\n\n\t\tif (min !== undefined) {\n\t\t\tthis.dom.min = min;\n\t\t}\n\n\t\tif (max !== undefined) {\n\t\t\tthis.dom.max = max;\n\t\t}\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\n\t\t\tthis.dom.value = value;\n\t\t}\n\t\treturn this;\n\t}\n}\n\n/**\n * UIBreak\n */\nclass UIBreak extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('br'));\n\n\t\tthis.dom.className = 'Break';\n\t}\n}\n\n/**\n * UIHorizontalRule\n */\nclass UIHorizontalRule extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('hr'));\n\n\t\tthis.dom.className = 'HorizontalRule';\n\t}\n}\n\n/**\n * UIButton\n * @param {any} value\n */\nclass UIButton extends UIElement {\n\n\tconstructor(value) {\n\n\t\tsuper(document.createElement('input'));\n\n\t\tthis.dom.type = 'button';\n\n\t\tif (value !== undefined) {\n\n\t\t\tthis.dom.value = value;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\nclass UIProgress extends UIElement {\n\n\tconstructor(value) {\n\n\t\tsuper(document.createElement('progress'));\n\n\t\tthis.dom.value = value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t}\n}\n\n/**\n * UITabbedPanel\n */\nclass UITabbedPanel extends UIDiv {\n\n\t/**\n\t * Constructor\n\t * @param {*} align (horizontal | vertical)\n\t */\n\tconstructor(align) {\n\n\t\tsuper();\n\n\t\tthis.tabs = [];\n\t\tthis.panels = [];\n\t\tthis.selector = new UISpan().setClass('tab-selector');\n\n\t\tthis.tabsDiv = new UIDiv();\n\t\tthis.tabsDiv.dom.className = 'tabs';\n\t\tthis.tabsDiv.add(this.selector);\n\n\t\tthis.panelsDiv = new UIDiv();\n\t\tthis.panelsDiv.dom.className = 'panels';\n\n\t\tthis.add(this.tabsDiv);\n\t\tthis.add(this.panelsDiv);\n\n\t\tthis.align = align || 'horizontal';\n\t\tthis.selected = '';\n\t}\n\n\tselect(id) {\n\n\t\tlet tab;\n\t\tlet panel;\n\n\t\t// Deselect current selection\n\t\tif (this.selected && this.selected.length) {\n\n\t\t\ttab = this.tabs.find((item) => {\n\n\t\t\t\treturn item.dom.id === this.selected;\n\t\t\t});\n\n\t\t\tpanel = this.panels.find((item) => {\n\n\t\t\t\treturn item.dom.id === this.selected;\n\t\t\t});\n\n\t\t\tif (tab) {\n\n\t\t\t\ttab.removeClass('selected');\n\t\t\t}\n\n\t\t\tif (panel) {\n\n\t\t\t\tpanel.setDisplay('none');\n\t\t\t}\n\t\t}\n\n\t\ttab = this.tabs.find(function (item) {\n\n\t\t\treturn item.dom.id === id;\n\t\t});\n\n\t\tpanel = this.panels.find(function (item) {\n\n\t\t\treturn item.dom.id === id;\n\t\t});\n\n\t\tif (tab) {\n\n\t\t\ttab.addClass('selected');\n\t\t\t//\n\t\t\t// transforming the tab-selector element\n\t\t\t//\n\t\t\tlet size;\n\t\t\tconst rect = tab.dom.getBoundingClientRect();\n\t\t\tif (this.align === 'horizontal') {\n\t\t\t\tsize = rect.width * this.tabs.indexOf(tab);\n\t\t\t\tthis.selector.dom.style.transform = `translateX(${size}px)`;\n\t\t\t} else {\n\t\t\t\tsize = rect.height * this.tabs.indexOf(tab);\n\t\t\t\tthis.selector.dom.style.transform = `translateY(${size}px)`;\n\t\t\t}\n\t\t}\n\n\t\tif (panel) {\n\n\t\t\tpanel.setDisplay('');\n\t\t}\n\n\t\tthis.selected = id;\n\n\t\treturn this;\n\t}\n\n\taddTab(id, label, items) {\n\n\t\tconst tab = new UITab(label, this);\n\t\ttab.setId(id);\n\t\ttab.setClass('tab');\n\t\tthis.tabs.push(tab);\n\t\tthis.tabsDiv.add(tab);\n\n\t\tconst panel = new UIDiv();\n\t\tpanel.setId(id);\n\t\tpanel.add(items);\n\t\tpanel.setDisplay('none');\n\t\tthis.panels.push(panel);\n\t\tthis.panelsDiv.add(panel);\n\n\t\tthis.select(id);\n\t}\n}\n\n/**\n * UITab\n */\nclass UITab extends UIDiv {\n\n\tconstructor(text, parent) {\n\n\t\tsuper(text);\n\n\t\tthis.button = new UIInput('button');\n\t\tthis.button.dom.title = text;\n\t\tthis.parent = parent;\n\t\tthis.dom.addEventListener('click', () => {\n\n\t\t\tthis.parent.select(this.dom.id);\n\n\t\t});\n\t\tthis.add(this.button);\n\t}\n}\n\n/**\n * UIListbox\n */\nclass UIListbox extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('select'));\n\n\t\tthis.dom.multiple = true;\n\n\t\tthis.items = [];\n\t\tthis.listItems = [];\n\t\tthis.selectedIndex = -1;\n\t\tthis.selectedValue = null;\n\n\t\treturn this;\n\t}\n\n\tsetItems(items) {\n\n\t\tthis.items = items;\n\t\tthis.dom.options.length = 0;\n\n\t\tfor (let i = 0; i < items.length; i++) {\n\n\t\t\tthis.setItem(items[i]);\n\t\t}\n\t}\n\n\tselectIndex(index) {\n\n\t\tthis.selectValue(index);\n\t}\n\n\tselectValue(index) {\n\n\t\tlet value = null;\n\n\t\tfor (let i = 0; i < this.dom.options.length; i++) {\n\n\t\t\tconst option = this.dom.options[i];\n\n\t\t\tif (index === i) {\n\n\t\t\t\toption.selected = true;\n\t\t\t\toption.className = 'selected';\n\t\t\t\tvalue = parseInt(option.value);\n\n\t\t\t} else {\n\n\t\t\t\toption.selected = false;\n\t\t\t\toption.className = '';\n\t\t\t}\n\t\t}\n\n\t\tthis.selectedValue = value;\n\t\tthis.selectedIndex = index;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.selectedValue;\n\t}\n\n\tsetItem(item) {\n\n\t\tconst option = document.createElement('option');\n\t\toption.value = item.id;\n\t\toption.text = item.type;\n\t\toption.addEventListener('click', (event) => {\n\n\t\t\tthis.selectValue(event.target.index);\n\n\t\t}, false);\n\n\t\tthis.dom.appendChild(option);\n\t\tthis.listItems.push(item);\n\n\t\treturn this;\n\t}\n}\n\n/**\n * UITreeView\n */\nclass UITreeView extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(document.createElement('ul'));\n\t}\n}\n\n/**\n * UITreeViewItem\n * @param {*} id\n * @param {*} link\n * @param {*} parent\n */\nclass UITreeViewItem extends UIElement {\n\n\tconstructor(id, link, parent) {\n\n\t\tsuper(document.createElement('li'));\n\t\tthis.dom.id = id;\n\t\tthis.link = link;\n\t\tthis.parent = parent;\n\t\tthis.toggle = new UISpan().setClass('toggle-collapsed');\n\t\tthis.expander = new UIDiv().setId('expander');\n\t\tthis.expanded = false;\n\t\tthis.selected = false;\n\t\tthis.add([this.expander, this.link]);\n\t}\n\n\tsetItems(subItems) {\n\n\t\tthis.add(subItems);\n\t\tthis.toggle.dom.onclick = () => {\n\n\t\t\tif (this.expanded) {\n\t\t\t\tthis.collaps();\n\t\t\t} else {\n\t\t\t\tthis.expand();\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis.expander.add(this.toggle);\n\n\t\tif (!this.expanded) {\n\n\t\t\tconst items = subItems.dom.getElementsByTagName('li');\n\t\t\tfor (let item of items) {\n\t\t\t\tif (item.className === 'selected') {\n\t\t\t\t\tthis.expand();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tselect() {\n\n\t\tthis.selected = true;\n\t\tthis.setClass('selected');\n\t}\n\n\tunselect() {\n\n\t\tthis.selected = false;\n\t\tthis.dom.removeAttribute('class');\n\t}\n\n\texpand() {\n\n\t\tthis.toggle.setClass('toggle-expanded');\n\t\tthis.dom.children[2].style.display = 'block';\n\t\tthis.expanded = true;\n\t}\n\n\tcollaps() {\n\n\t\tthis.toggle.setClass('toggle-collapsed');\n\t\tthis.dom.children[2].style.display = 'none';\n\t\tthis.expanded = false;\n\t}\n}\n\nexport {\n\tUIElement,\n\tUISpan,\n\tUIDiv,\n\tUIRow,\n\tUIPanel,\n\tUILabel,\n\tUIText,\n\tUILink,\n\tUIInput,\n\tUITextArea,\n\tUISelect,\n\tUICheckbox,\n\tUIColor,\n\tUINumber,\n\tUIInteger,\n\tUIBreak,\n\tUIHorizontalRule,\n\tUIButton,\n\tUIProgress,\n\tUITabbedPanel,\n\tUITab,\n\tUIListbox,\n\tUITreeView,\n\tUITreeViewItem\n};\n","import { UIPanel, UIText } from '../ui.js';\n\nexport class MetadataPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('metadata');\n\n\t\tthis.title = new UIText().setId('book-title');\n\t\tthis.creator = new UIText().setId('book-creator');\n\t\tthis.separator = new UIText().setId('book-title-separator');\n\n\t\tsuper.add([this.title, this.separator, this.creator]);\n\n\t\t//-- events --//\n\n\t\treader.on('metadata', (meta) => {\n\n\t\t\tthis.init(meta);\n\t\t});\n\t}\n\n\tinit(meta) {\n\n\t\tdocument.title = meta.title + \" – \" + meta.creator;\n\n\t\tthis.title.setValue(meta.title);\n\t\tthis.creator.setValue(meta.creator);\n\t\tthis.separator.dom.style.display = 'inline-block';\n\t}\n}\n","import { UIPanel, UIDiv, UIInput } from './ui.js';\nimport { MetadataPanel } from './sidebar/metadata.js';\n\nexport class Toolbar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\n\t\tconst container = new UIDiv().setId('toolbar');\n\n\t\tconst start = new UIPanel().setId('start');\n\t\tconst opener = new UIInput('button').setId('btn-s');\n\t\tconst openerStr = strings.get('toolbar/opener');\n\t\topener.dom.title = openerStr;\n\t\topener.dom.onclick = () => {\n\n\t\t\tconst isOpen = opener.dom.classList.length > 0;\n\n\t\t\treader.emit('sidebaropener', !isOpen);\n\n\t\t\tif (!isOpen) {\n\t\t\t\topener.addClass('open');\n\t\t\t} else {\n\t\t\t\topener.removeClass('open');\n\t\t\t}\n\t\t};\n\n\t\tstart.add(opener);\n\n\t\tconst center = new MetadataPanel(reader);\n\n\t\tconst end = new UIPanel().setId('end');\n\t\tconst open = new UIInput('file').setId('btn-o');\n\t\tconst uploadStr = strings.get('toolbar/openbook');\n\t\tconst storage = window.storage;\n\t\topen.dom.title = uploadStr;\n\t\topen.dom.accept = 'application/epub+zip';\n\t\topen.dom.addEventListener('change', function (e) {\n\n\t\t\tif (e.target.files.length === 0)\n\t\t\t\treturn;\n\n\t\t\tif (window.FileReader) {\n\n\t\t\t\tconst fr = new FileReader();\n\t\t\t\tfr.onload = function (e) {\n\t\t\t\t\tstorage.clear();\n\t\t\t\t\tstorage.set(e.target.result, () => {\n\t\t\t\t\t\treader.unload();\n\t\t\t\t\t\treader.init(e.target.result, { restore: true });\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tfr.readAsArrayBuffer(e.target.files[0]);\n\t\t\t\tfr.onerror = function (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t};\n\n\t\t\t\tif (window.location.href.includes(\"?bookPath=\")) {\n\t\t\t\t\twindow.location.href = window.location.origin + window.location.pathname;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\talert(strings.get('toolbar/openbook/error'));\n\t\t\t}\n\t\t}, false);\n\n\t\tend.add(open);\n\n\t\tconst bookmark = new UIInput('button').setId('btn-b');\n\t\tconst bookmarkStr = strings.get('toolbar/bookmark');\n\t\tbookmark.dom.title = bookmarkStr;\n\t\tbookmark.dom.addEventListener('click', () => {\n\n\t\t\tconst cfi = reader.rendition.currentLocation().start.cfi;\n\t\t\treader.emit('bookmarked', reader.isBookmarked(cfi) === -1);\n\t\t});\n\n\t\tend.add(bookmark);\n\n\t\tif (document.fullscreenEnabled) {\n\n\t\t\tconst fullscreen = new UIInput('button').setId('btn-f');\n\t\t\tconst fullscreenStr = strings.get('toolbar/fullsceen');\n\t\t\tfullscreen.dom.title = fullscreenStr;\n\t\t\tfullscreen.dom.addEventListener('click', () => {\n\n\t\t\t\tthis.toggleFullScreen();\n\t\t\t});\n\n\t\t\tdocument.addEventListener('keydown', (e) => {\n\n\t\t\t\tif (e.key === 'F11') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.toggleFullScreen();\n\t\t\t\t}\n\t\t\t}, false);\n\n\t\t\tdocument.addEventListener('fullscreenchange', (e) => {\n\t\t\t\t\n\t\t\t\tconst w = window.screen.width === e.target.clientWidth;\n\t\t\t\tconst h = window.screen.height === e.target.clientHeight;\n\n\t\t\t\tif (w && h) {\n\t\t\t\t\tfullscreen.addClass('resize-small');\n\t\t\t\t} else {\n\t\t\t\t\tfullscreen.removeClass('resize-small');\n\t\t\t\t}\n\t\t\t}, false);\n\n\t\t\tend.add(fullscreen);\n\t\t}\n\n\t\tcontainer.add([start, center, end]);\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on('relocated', (location) => {\n\n\t\t\tconst cfi = location.start.cfi;\n\n\t\t\tif (reader.isBookmarked(cfi) === -1) {\n\t\t\t\tbookmark.removeClass('bookmarked');\n\t\t\t} else {\n\t\t\t\tbookmark.addClass('bookmarked');\n\t\t\t}\n\t\t});\n\n\t\treader.on('bookmarked', (value) => {\n\n\t\t\tif (value) {\n\t\t\t\tbookmark.addClass('bookmarked');\n\t\t\t} else {\n\t\t\t\tbookmark.removeClass('bookmarked');\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleFullScreen() {\n\n\t\tdocument.activeElement.blur();\n\n\t\tif (document.fullscreenElement === null) {\n\t\t\tdocument.documentElement.requestFullscreen();\n\t\t} else if (document.exitFullscreen) {\n\t\t\tdocument.exitFullscreen();\n\t\t}\n\t}\n}\n","import { UIPanel, UITreeView, UITreeViewItem, UILink } from '../ui.js';\n\nexport class TocPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('contents');\n\n\t\tthis.reader = reader;\n\t\tthis.selector = undefined; // save reference to selected tree item\n\n\t\t//-- events --//\n\n\t\treader.on('navigation', (toc) => {\n\n\t\t\tthis.init(toc);\n\t\t});\n\t}\n\n\tinit(toc) {\n\n\t\tsuper.clear();\n\t\tsuper.add(this.generateToc(toc));\n\t}\n\n\tgenerateToc(toc, parent) {\n\n\t\tconst container = new UITreeView();\n\n\t\ttoc.forEach((chapter) => {\n\n\t\t\tconst link = new UILink(chapter.href, chapter.label);\n\t\t\tconst treeItem = new UITreeViewItem(chapter.id, link, parent);\n\n\t\t\tlink.dom.onclick = () => {\n\n\t\t\t\tthis.reader.rendition.display(chapter.href);\n\t\t\t\tif (this.selector && this.selector !== treeItem) {\n\t\t\t\t\tthis.selector.unselect();\n\t\t\t\t}\n\t\t\t\ttreeItem.select();\n\t\t\t\tthis.selector = treeItem;\n\t\t\t\tthis.reader.emit('tocselected', chapter.id);\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tif (this.reader.settings.sectionId === chapter.id) {\n\t\t\t\ttreeItem.select();\n\t\t\t\tthis.selector = treeItem;\n\t\t\t}\n\n\t\t\tif (chapter.subitems && chapter.subitems.length > 0) {\n\n\t\t\t\ttreeItem.setItems(this.generateToc(chapter.subitems, treeItem));\n\t\t\t}\n\n\t\t\tcontainer.add(treeItem);\n\t\t});\n\n\t\treturn container;\n\t}\n}\n","import { UIPanel, UIRow, UIInput } from '../ui.js';\n\nexport class BookmarksPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('bookmarks');\n\n\t\tconst strings = reader.strings;\n\n\t\tconst ctrlRow = new UIRow();\n\t\tconst ctrlStr = [\n\t\t\tstrings.get('sidebar/bookmarks/add'),\n\t\t\tstrings.get('sidebar/bookmarks/remove'),\n\t\t\tstrings.get('sidebar/bookmarks/clear'),\n\t\t];\n\t\tconst btn_a = new UIInput('button', ctrlStr[0]).addClass('btn-start');\n\t\tconst btn_r = new UIInput('button', ctrlStr[1]).addClass('btn-medium');\n\t\tconst btn_c = new UIInput('button', ctrlStr[2]).addClass('btn-end');\n\n\t\tbtn_a.dom.onclick = () => {\n\n\t\t\treader.emit('bookmarked', true);\n\t\t\treturn false;\n\t\t};\n\n\t\tbtn_r.dom.onclick = () => {\n\n\t\t\treader.emit('bookmarked', false);\n\t\t\treturn false;\n\t\t};\n\n\t\tbtn_c.dom.onclick = () => {\n\n\t\t\tthis.clearBookmarks();\n\t\t\treader.emit('bookmarked', false);\n\t\t\treturn false;\n\t\t};\n\n\t\tctrlRow.add([btn_a, btn_r, btn_c]);\n\n\t\tthis.reader = reader;\n\t\tthis.bookmarks = document.createElement('ul');\n\n\t\tsuper.add(ctrlRow);\n\t\tthis.dom.appendChild(this.bookmarks);\n\n\t\tconst update = () => {\n\n\t\t\tbtn_r.dom.disabled = reader.settings.bookmarks.length === 0;\n\t\t\tbtn_c.dom.disabled = reader.settings.bookmarks.length === 0;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on('bookready', () => {\n\n\t\t\treader.settings.bookmarks.forEach((cfi) => {\n\n\t\t\t\tconst bookmark = this.createBookmarkItem(cfi);\n\t\t\t\tthis.bookmarks.appendChild(bookmark);\n\t\t\t});\n\n\t\t\tupdate();\n\t\t});\n\n\t\treader.on('relocated', (location) => {\n\n\t\t\tconst cfi = location.start.cfi;\n\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\tbtn_a.dom.disabled = !val;\n\t\t\tbtn_r.dom.disabled = val;\n\t\t});\n\n\t\treader.on('bookmarked', (value) => {\n\n\t\t\tconst cfi = reader.rendition.currentLocation().start.cfi;\n\n\t\t\tif (value) {\n\t\t\t\tthis.addBookmark(cfi);\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t} else {\n\t\t\t\tthis.removeBookmark(cfi);\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t}\n\n\t\t\tupdate();\n\t\t});\n\t}\n\n\taddBookmark(cfi) {\n\n\t\tif (this.reader.isBookmarked(cfi) > -1)\n\t\t\treturn;\n\n\t\tconst bookmark = this.createBookmarkItem(cfi);\n\t\tthis.bookmarks.appendChild(bookmark);\n\t\tthis.reader.settings.bookmarks.push(cfi);\n\t}\n\n\tremoveBookmark(cfi) {\n\n\t\tconst index = this.reader.isBookmarked(cfi);\n\t\tif (index === -1)\n\t\t\treturn;\n\n\t\tthis.bookmarks.removeChild(this.bookmarks.childNodes[index]);\n\t\tthis.reader.settings.bookmarks.splice(index, 1);\n\t}\n\n\tclearBookmarks() {\n\n\t\tthis.reader.settings.bookmarks = [];\n\t\twhile (this.bookmarks.hasChildNodes()) {\n\t\t\tthis.bookmarks.removeChild(this.bookmarks.lastChild);\n\t\t}\n\t}\n\n\tcreateBookmarkItem(cfi) {\n\n\t\tconst item = document.createElement('li');\n\t\tconst link = document.createElement('a');\n\n\t\tconst book = this.reader.book;\n\t\tconst spineItem = book.spine.get(cfi);\n\n\t\tif (spineItem.index in book.navigation.toc) {\n\t\t\tconst tocItem = book.navigation.toc[spineItem.index];\n\t\t\titem.id = tocItem.id;\n\t\t\tlink.textContent = tocItem.label;\n\t\t} else {\n\t\t\tlink.textContent = cfi;\n\t\t}\n\n\t\tlink.href = \"#\" + cfi;\n\t\tlink.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(cfi);\n\t\t\treturn false;\n\t\t};\n\n\t\titem.appendChild(link);\n\t\treturn item;\n\t}\n}\n","import { UIPanel, UIRow, UITextArea, UIInput } from '../ui.js';\n\nexport class AnnotationsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('annotations');\n\n\t\tconst strings = reader.strings;\n\t\tconst ctrlStr = [\n\t\t\tstrings.get('sidebar/annotations/add'),\n\t\t\tstrings.get('sidebar/annotations/clear')\n\t\t];\n\n\t\tthis.reader = reader;\n\t\tthis.notes = document.createElement('ul');\n\n\t\tconst textBox = new UITextArea();\n\t\ttextBox.dom.addEventListener('input', (e) => {\n\n\t\t\tif (isSelected() && e.target.value.length > 0) {\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t} else {\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t}\n\t\t});\n\n\t\tconst selector = {\n\t\t\trange: undefined,\n\t\t\tcfiRange: undefined\n\t\t};\n\n\t\tconst textRow = new UIRow();\n\t\tconst ctrlRow = new UIRow();\n\n\t\tconst btn_a = new UIInput('button', ctrlStr[0]).addClass('btn-start');\n\t\tbtn_a.dom.disabled = true;\n\t\tbtn_a.dom.onclick = () => {\n\n\t\t\tconst note = {\n\t\t\t\tdate: new Date(),\n\t\t\t\ttext: textBox.getValue(),\n\t\t\t\thref: selector.cfiRange,\n\t\t\t\tuuid: reader.uuid()\n\t\t\t};\n\n\t\t\treader.settings.annotations.push(note);\n\n\t\t\tthis.add(note);\n\n\t\t\ttextBox.setValue('');\n\t\t\tbtn_a.dom.disabled = true;\n\t\t\treturn false;\n\t\t};\n\n\t\tconst btn_c = new UIInput('button', ctrlStr[1]).addClass('btn-end');\n\t\tbtn_c.dom.disabled = true;\n\t\tbtn_c.dom.onclick = () => {\n\n\t\t\tthis.clearNotes();\n\t\t\treturn false;\n\t\t};\n\n\t\ttextRow.add(textBox);\n\t\tctrlRow.add([btn_a, btn_c]);\n\n\t\tsuper.add([textRow, ctrlRow]);\n\t\tthis.dom.appendChild(this.notes);\n\n\t\tthis.update = () => {\n\n\t\t\tbtn_c.dom.disabled = reader.settings.annotations.length === 0;\n\t\t};\n\n\t\tconst isSelected = () => {\n\n\t\t\treturn selector.range && selector.range.startOffset !== selector.range.endOffset;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on('bookready', () => {\n\n\t\t\treader.settings.annotations.forEach((note) => {\n\n\t\t\t\tthis.add(note);\n\t\t\t});\n\t\t});\n\n\t\treader.on('selected', (cfiRange, contents) => {\n\n\t\t\tselector.range = contents.range(cfiRange);\n\t\t\tselector.cfiRange = cfiRange;\n\n\t\t\tif (isSelected() && textBox.getValue().length > 0) {\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t} else {\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t}\n\t\t});\n\n\t\treader.on('unselected', () => {\n\n\t\t\tbtn_a.dom.disabled = true;\n\t\t});\n\t}\n\n\tadd(note) {\n\n\t\tconst item = document.createElement('li');\n\t\tconst link = document.createElement('a');\n\t\tconst btnr = document.createElement('span');\n\t\tconst call = () => { };\n\n\t\tlink.href = \"#\" + note.href;\n\t\tlink.textContent = note.text;\n\t\tlink.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(note.href);\n\t\t\treturn false;\n\t\t};\n\n\t\titem.id = 'note-' + note.uuid;\n\t\titem.appendChild(link);\n\n\t\tbtnr.className = 'btn-remove';\n\t\tbtnr.onclick = () => {\n\n\t\t\tthis.remove(note);\n\t\t\treturn false;\n\t\t};\n\n\t\titem.appendChild(btnr);\n\n\t\tthis.notes.appendChild(item);\n\t\tthis.reader.rendition.annotations.add(\n\t\t\t\"highlight\", note.href, {}, call, \"note-highlight\", {});\n\t\tthis.update();\n\t}\n\n\tremove(note) {\n\n\t\tconst index = this.reader.settings.annotations.indexOf(note);\n\t\tif (index === -1)\n\t\t\treturn;\n\n\t\tthis.notes.removeChild(this.notes.childNodes[index]);\n\t\tthis.reader.settings.annotations.splice(index, 1);\n\t\tthis.reader.rendition.annotations.remove(note.href, \"highlight\");\n\t\tthis.update();\n\t}\n\n\tclearNotes() {\n\n\t\tconst len = this.reader.settings.annotations.length;\n\t\tfor (let i = 0; i < len; i++) {\n\n\t\t\tthis.remove(this.reader.settings.annotations[i]);\n\t\t}\n\t}\n}\n","import { UIPanel, UIRow, UIInput } from '../ui.js';\n\nexport class SearchPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('search');\n\n\t\tconst strings = reader.strings;\n\n\t\tlet searchQuery = undefined;\n\t\tconst searchBox = new UIInput('search');\n\t\tsearchBox.dom.placeholder = strings.get('sidebar/search/placeholder');\n\t\tsearchBox.dom.onsearch = () => {\n\n\t\t\tconst value = searchBox.getValue();\n\n\t\t\tif (value.length === 0) {\n\t\t\t\tthis.clear();\n\t\t\t} else if (searchQuery !== value) {\n\t\t\t\tthis.clear();\n\t\t\t\tthis.doSearch(value).then(results => {\n\n\t\t\t\t\tresults.forEach(item => {\n\t\t\t\t\t\tthis.set(item);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tsearchQuery = value;\n\t\t};\n\n\t\tconst ctrlRow = new UIRow();\n\t\tctrlRow.add(searchBox);\n\t\tsuper.add(ctrlRow);\n\n\t\tthis.items = document.createElement('ul');\n\t\tthis.dom.appendChild(this.items);\n\t\tthis.reader = reader;\n\t\t//\n\t\t// improvement of the highlighting of keywords is required...\n\t\t//\n\t}\n\n\t/**\n\t * Searching the entire book\n\t * @param {*} q Query keyword\n\t * @returns The search result array.\n\t */\n\tasync doSearch(q) {\n\n\t\tconst book = this.reader.book;\n\t\tconst results = await Promise.all(\n\t\t\tbook.spine.spineItems.map(item => item.load(book.load.bind(book))\n\t\t\t\t.then(item.find.bind(item, q)).finally(item.unload.bind(item))));\n\t\treturn await Promise.resolve([].concat.apply([], results));\n\t}\n\n\tset(data) {\n\n\t\tconst item = document.createElement('li');\n\t\tconst link = document.createElement('a');\n\n\t\tlink.href = \"#\" + data.cfi;\n\t\tlink.textContent = data.excerpt;\n\t\tlink.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(data.cfi);\n\t\t\treturn false;\n\t\t};\n\n\t\titem.appendChild(link);\n\t\tthis.items.appendChild(item);\n\t}\n\n\tclear() {\n\n\t\twhile (this.items.hasChildNodes()) {\n\t\t\tthis.items.removeChild(this.items.lastChild);\n\t\t}\n\t}\n}\n","import { UIPanel, UIRow, UISelect, UIInput, UILabel, UIInteger } from '../ui.js';\n\nexport class SettingsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId('settings');\n\n\t\tconst strings = reader.strings;\n\n\t\tconst languageStr = strings.get('sidebar/settings/language');\n\t\tconst languageRow = new UIRow();\n\t\tconst language = new UISelect().setOptions({\n\t\t\ten: 'English',\n\t\t\tfr: 'French',\n\t\t\tja: 'Japanese',\n\t\t\tru: 'Russian'\n\t\t});\n\t\tlanguage.dom.onchange = (e) => {\n\n\t\t\treader.settings.language = e.target.value;\n\t\t};\n\n\t\tlanguageRow.add(new UILabel(languageStr));\n\t\tlanguageRow.add(language);\n\n\t\tconst fontSizeStr = strings.get(\"sidebar/settings/fontsize\");\n\t\tconst fontSizeRow = new UIRow();\n\t\tconst fontSize = new UIInteger(100, 1);\n\t\tfontSize.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"styleschanged\", {\n\t\t\t\tfontSize: parseInt(e.target.value)\n\t\t\t});\n\t\t};\n\n\t\tfontSizeRow.add(new UILabel(fontSizeStr));\n\t\tfontSizeRow.add(fontSize);\n\n\t\t// -- layout configure -- //\n\n\t\tconst layoutStr = strings.get(\"sidebar/settings/layout\");\n\t\tconst layoutRow = new UIRow();\n\t\tconst layout = new UISelect().setOptions({\n\t\t\tpaginated: \"Paginated\",\n\t\t\tscrolled: \"Scrolled\"\n\t\t});\n\t\tlayout.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"layoutchanged\", e.target.value);\n\n\t\t\tif (e.target.value === \"scrolled\") {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: \"none\",\n\t\t\t\t\tmin: reader.settings.spread[\"min\"]\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: reader.settings.spread[\"mod\"],\n\t\t\t\t\tmin: reader.settings.spread[\"min\"]\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tlayoutRow.add(new UILabel(layoutStr));\n\t\tlayoutRow.add(layout);\n\n\t\t// -- spdead configure -- //\n\n\t\tconst spreadStr = strings.get(\"sidebar/settings/spread\");\n\t\tconst spreadRow = new UIRow();\n\t\tconst spread = new UISelect().setOptions({\n\t\t\tnone: \"None\",\n\t\t\tauto: \"Auto\"\n\t\t});\n\t\tspread.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: e.target.value,\n\t\t\t\tmin: reader.settings.spread[\"min\"]\n\t\t\t});\n\t\t};\n\n\t\tspreadRow.add(new UILabel(spreadStr));\n\t\tspreadRow.add(spread);\n\n\t\tconst minSpreadWidthStr = strings.get(\"sidebar/settings/spread/pagewidth\");\n\t\tconst minSpreadWidthRow = new UIRow();\n\t\tconst minSpreadWidth = new UIInteger(800, 1);\n\t\tminSpreadWidth.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: reader.settings.spread[\"mod\"],\n\t\t\t\tmin: e.target.value\n\t\t\t});\n\t\t};\n\n\t\tminSpreadWidthRow.add(new UILabel(minSpreadWidthStr));\n\t\tminSpreadWidthRow.add(minSpreadWidth);\n\n\t\t// -- pagination -- //\n\n\t\tconst paginationStr = strings.get('sidebar/settings/pagination');\n\t\tconst paginationRow = new UIRow();\n\t\tconst pagination = new UIInput('checkbox', false, paginationStr[1]);\n\t\tpagination.setId('pagination');\n\t\tpagination.dom.addEventListener('click', (e) => {\n\n\t\t\treader.settings.pagination = e.target.checked;\n\t\t\treader.generatePagination(); // not implemented\n\t\t});\n\n\t\tpaginationRow.add(new UILabel(paginationStr[0], 'pagination'));\n\t\tpaginationRow.add(pagination);\n\n\t\tsuper.add([\n\t\t\tlanguageRow,\n\t\t\tfontSizeRow,\n\t\t\tlayoutRow,\n\t\t\tspreadRow,\n\t\t\tminSpreadWidthRow,\n\t\t\t//paginationRow\n\t\t]);\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", () => {\n\n\t\t\tlanguage.setValue(reader.settings.language);\n\t\t});\n\n\t\treader.on(\"layout\", (props) => {\n\n\t\t\tconst value = props[\"flow\"] === \"scrolled\";\n\t\t\tspread.dom.disabled = value;\n\t\t});\n\n\t\treader.on(\"layoutchanged\", (value) => {\n\n\t\t\tif (layout.getValue() !== value) {\n\t\t\t\tlayout.setValue(value);\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"styleschanged\", (value) => {\n\n\t\t\tif (fontSize.getValue() !== value[\"fontSize\"]) {\n\t\t\t\tfontSize.setValue(value[\"fontSize\"]);\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"spreadchanged\", (value) => {\n\n\t\t\tif (spread.getValue() !== value[\"mod\"]) {\n\t\t\t\tspread.setValue(value[\"mod\"]);\n\t\t\t}\n\n\t\t\tif (minSpreadWidth.getValue() !== value[\"min\"]) {\n\t\t\t\tminSpreadWidth.setValue(value[\"min\"]);\n\t\t\t}\n\t\t});\n\t}\n}\n","import { UITabbedPanel } from './ui.js';\nimport { TocPanel } from './sidebar/toc.js';\nimport { BookmarksPanel } from './sidebar/bookmarks.js';\nimport { AnnotationsPanel } from './sidebar/annotations.js';\nimport { SearchPanel } from './sidebar/search.js';\nimport { SettingsPanel } from './sidebar/settings.js';\n\nexport class Sidebar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\t\tconst tabs = [\n\t\t\tstrings.get('sidebar/contents'),\n\t\t\tstrings.get('sidebar/bookmarks'),\n\t\t\tstrings.get('sidebar/annotations'),\n\t\t\tstrings.get('sidebar/search'),\n\t\t\tstrings.get('sidebar/settings')\n\t\t];\n\n\t\tconst container = new UITabbedPanel('vertical').setId('sidebar');\n\n\t\tcontainer.addTab('tab-t', tabs[0], new TocPanel(reader));\n\t\tcontainer.addTab('tab-b', tabs[1], new BookmarksPanel(reader));\n\t\tcontainer.addTab('tab-n', tabs[2], new AnnotationsPanel(reader));\n\t\tcontainer.addTab('tab-s', tabs[3], new SearchPanel(reader));\n\t\tcontainer.addTab('tab-c', tabs[4], new SettingsPanel(reader));\n\t\tcontainer.select('tab-t');\n\n\t\tdocument.body.appendChild(container.dom);\n\t}\n}\n","import { UIDiv, UILabel } from './ui.js';\n\nexport class Content {\n\n\tconstructor(reader) {\n\n\t\tthis.main = new UIDiv().setId('content');\n\t\tthis.main.dom.addEventListener('transitionend', (e) => {\n\n\t\t\tif (reader.settings.sidebarReflow) {\n\t\t\t\treader.rendition.resize();\n\t\t\t}\n\t\t});\n\n\t\tconst prev = new UIDiv().setId('prev').setClass('arrow');\n\t\tprev.dom.onclick = (e) => {\n\n\t\t\treader.emit('prev');\n\t\t\te.preventDefault();\n\t\t};\n\t\tprev.add(new UILabel('<'));\n\n\t\tconst next = new UIDiv().setId('next').setClass('arrow');\n\t\tnext.dom.onclick = (e) => {\n\n\t\t\treader.emit('next');\n\t\t\te.preventDefault();\n\t\t};\n\t\tnext.add(new UILabel('>'));\n\n\t\tconst viewer = new UIDiv().setId('viewer');\n\t\tconst divider = new UIDiv().setId('divider');\n\t\tconst loader = new UIDiv().setId('loader');\n\n\t\tconst showDivider = () => {\n\t\t\tdivider.dom.style.display = 'block';\n\t\t};\n\n\t\tconst hideDivider = () => {\n\t\t\tdivider.dom.style.display = 'none';\n\t\t};\n\n\t\tconst showLoader = () => {\n\t\t\tloader.dom.style.display = 'block';\n\t\t\thideDivider();\n\t\t};\n\n\t\tconst hideLoader = () => {\n\t\t\tloader.dom.style.display = 'none';\n\n\t\t\t//-- If the book is using spreads, show the divider\n\t\t\tif (reader.book.settings.spreads) {\n\t\t\t\tshowDivider();\n\t\t\t}\n\t\t};\n\n\t\tthis.main.add([prev, viewer, next, divider, loader]);\n\n\t\tthis.reader = reader;\n\n\t\tdocument.body.appendChild(this.main.dom);\n\n\t\t//-- events --//\n\n\t\treader.on('bookloaded', () => {\n\n\t\t\thideLoader();\n\t\t});\n\n\t\treader.on('sidebaropener', (value) => {\n\n\t\t\tif (value) {\n\t\t\t\tthis.slideOut();\n\t\t\t} else {\n\t\t\t\tthis.slideIn();\n\t\t\t}\n\t\t});\n\n\t\treader.on('layout', (props) => {\n\n\t\t\tif (props.spread === true && props.width > props.spreadWidth) {\n\t\t\t\tshowDivider();\n\t\t\t} else {\n\t\t\t\thideDivider();\n\t\t\t}\n\t\t});\n\n\t\treader.on('relocated', (location) => {\n\n\t\t\tif (location.atStart) {\n\t\t\t\tprev.addClass('disabled');\n\t\t\t} else {\n\t\t\t\tprev.removeClass('disabled');\n\t\t\t}\n\n\t\t\tif (location.atEnd) {\n\t\t\t\tnext.addClass('disabled');\n\t\t\t} else {\n\t\t\t\tnext.removeClass('disabled');\n\t\t\t}\n\t\t});\n\n\t\treader.on('prev', () => {\n\n\t\t\tprev.addClass('active');\n\t\t\tsetTimeout(() => { prev.removeClass('active'); }, 100);\n\t\t});\n\n\t\treader.on('next', () => {\n\n\t\t\tnext.addClass('active');\n\t\t\tsetTimeout(() => { next.removeClass('active'); }, 100);\n\t\t});\n\n\t\treader.on('viewercleanup', () => {\n\n\t\t\tviewer.clear();\n\t\t});\n\t}\n\n\tslideIn() {\n\n\t\t//var currentPosition = rendition.currentLocation().start.cfi;\n\t\tif (this.reader.settings.sidebarReflow) {\n\t\t\t//this.main.removeClass('single');\n\t\t} else {\n\t\t\t//this.main.removeClass('closed');\n\t\t}\n\n\t\tthis.main.removeClass('single');\n\t\tthis.main.removeClass('closed');\n\t}\n\n\tslideOut() {\n\t\t/*\n\t\tvar location = rendition.currentLocation();\n\t\tif (!location) {\n\t\t\treturn;\n\t\t}\n\t\tvar currentPosition = location.start.cfi;\n\t\t*/\n\t\tif (this.reader.settings.sidebarReflow) {\n\t\t\tthis.main.addClass('single');\n\t\t} else {\n\t\t\tthis.main.addClass('closed');\n\t\t}\n\t}\n}\n","export class Strings {\n\n\tconstructor(reader) {\n\n\t\tthis.language = reader.settings.language || 'en';\n\t\tthis.values = {\n\t\t\ten: {\n\t\t\t\t'toolbar/opener': 'Sidebar',\n\t\t\t\t'toolbar/openbook': 'Open book',\n\t\t\t\t'toolbar/openbook/error': 'Your browser does not support the required features.\\nPlease use a modern browser such as Google Chrome, or Mozilla Firefox.',\n\t\t\t\t'toolbar/bookmark': 'Add this page to bookmarks',\n\t\t\t\t'toolbar/fullsceen': 'Fullscreen',\n\n\t\t\t\t'sidebar/contents': 'Contents',\n\t\t\t\t'sidebar/bookmarks': 'Bookmarks',\n\t\t\t\t'sidebar/bookmarks/add': 'Add',\n\t\t\t\t'sidebar/bookmarks/remove': 'Remove',\n\t\t\t\t'sidebar/bookmarks/clear': 'Clear',\n\t\t\t\t'sidebar/annotations': 'Annotations',\n\t\t\t\t'sidebar/annotations/add': 'Add',\n\t\t\t\t'sidebar/annotations/clear': 'Clear',\n\t\t\t\t'sidebar/annotations/anchor': 'Anchor',\n\t\t\t\t'sidebar/annotations/cancel': 'Cancel',\n\t\t\t\t'sidebar/search': 'Search',\n\t\t\t\t'sidebar/search/placeholder': 'search',\n\t\t\t\t'sidebar/settings': 'Settings',\n\t\t\t\t'sidebar/settings/language': 'Language',\n\t\t\t\t'sidebar/settings/fontsize': 'Font size (%)',\n\t\t\t\t'sidebar/settings/layout': 'Layout',\n\t\t\t\t'sidebar/settings/pagination': ['Pagination', 'Generate pagination'],\n\t\t\t\t'sidebar/settings/spread': 'Spread',\n\t\t\t\t'sidebar/settings/spread/pagewidth': 'Page width'\n\t\t\t},\n\t\t\tfr: {\n\t\t\t\t'toolbar/opener': 'Barre latérale',\n\t\t\t\t'toolbar/openbook': 'Ouvrir un livre local',\n\t\t\t\t'toolbar/openbook/error': 'Votre navigateur ne prend pas en charge les fonctions nécessaires.\\nVeuillez utiliser un navigateur moderne tel que Google Chrome ou Mozilla Firefox.',\n\t\t\t\t'toolbar/bookmark': 'Insérer un marque page ici',\n\t\t\t\t'toolbar/fullsceen': 'Plein écran',\n\n\t\t\t\t'sidebar/contents': 'Sommaire',\n\t\t\t\t'sidebar/bookmarks': 'Marque-pages',\n\t\t\t\t'sidebar/bookmarks/add': 'Ajouter',\n\t\t\t\t'sidebar/bookmarks/remove': 'Retirer',\n\t\t\t\t'sidebar/bookmarks/clear': 'Tout enlever',\n\t\t\t\t'sidebar/annotations': 'Annotations',\n\t\t\t\t'sidebar/annotations/add': 'Ajouter',\n\t\t\t\t'sidebar/annotations/clear': 'Tout enlever',\n\t\t\t\t'sidebar/annotations/anchor': 'Ancre',\n\t\t\t\t'sidebar/annotations/cancel': 'Annuler',\n\t\t\t\t'sidebar/search': 'Rechercher',\n\t\t\t\t'sidebar/search/placeholder': 'rechercher',\n\t\t\t\t'sidebar/settings': 'Réglages',\n\t\t\t\t'sidebar/settings/language': 'Langue',\n\t\t\t\t'sidebar/settings/fontsize': '???',\n\t\t\t\t'sidebar/settings/layout': '???',\n\t\t\t\t'sidebar/settings/pagination': ['Pagination', 'Établir une pagination'],\n\t\t\t\t'sidebar/settings/spread': '???',\n\t\t\t\t'sidebar/settings/spread/pagewidth': '???'\n\t\t\t},\n\t\t\tja: {\n\t\t\t\t'toolbar/opener': 'サイドバー',\n\t\t\t\t'toolbar/openbook': '本を開く',\n\t\t\t\t'toolbar/openbook/error': 'ご利用のブラウザは必要な機能をサポートしていません。\\nGoogle Chrome、Mozilla Firefox、その他のモダンなブラウザでご利用ください。',\n\t\t\t\t'toolbar/bookmark': 'このページに栞を設定する',\n\t\t\t\t'toolbar/fullsceen': 'フルスクリーン',\n\n\t\t\t\t'sidebar/contents': '目次',\n\t\t\t\t'sidebar/bookmarks': '栞',\n\t\t\t\t'sidebar/bookmarks/add': '追加',\n\t\t\t\t'sidebar/bookmarks/remove': '削除',\n\t\t\t\t'sidebar/bookmarks/clear': 'クリア',\n\t\t\t\t'sidebar/annotations': '注釈',\n\t\t\t\t'sidebar/annotations/add': '追加',\n\t\t\t\t'sidebar/annotations/clear': 'クリア',\n\t\t\t\t'sidebar/annotations/anchor': 'アンカー',\n\t\t\t\t'sidebar/annotations/cancel': 'キャンセル',\n\t\t\t\t'sidebar/search': '検索',\n\t\t\t\t'sidebar/search/placeholder': '検索',\n\t\t\t\t'sidebar/settings': '設定',\n\t\t\t\t'sidebar/settings/language': '表示言語',\n\t\t\t\t'sidebar/settings/fontsize': '???',\n\t\t\t\t'sidebar/settings/layout': '???',\n\t\t\t\t'sidebar/settings/pagination': ['ページネーション', 'ページネーションを生成します。'],\n\t\t\t\t'sidebar/settings/spread': '???',\n\t\t\t\t'sidebar/settings/spread/pagewidth': '???'\n\t\t\t},\n\t\t\tru: {\n\t\t\t\t'toolbar/opener': 'Боковая панель',\n\t\t\t\t'toolbar/openbook': 'Открыть книгу',\n\t\t\t\t'toolbar/openbook/error': 'Ваш браузер не поддерживает необходимые функции.\\nПожалуйста, используйте современный браузер, такой как Google Chrome или Mozilla Firefox.',\n\t\t\t\t'toolbar/bookmark': 'Добавить эту страницу в закладки',\n\t\t\t\t'toolbar/fullsceen': 'Полноэкранный режим',\n\n\t\t\t\t'sidebar/contents': 'Содержание',\n\t\t\t\t'sidebar/bookmarks': 'Закладки',\n\t\t\t\t'sidebar/bookmarks/add': 'Добавить',\n\t\t\t\t'sidebar/bookmarks/remove': 'Удалить',\n\t\t\t\t'sidebar/bookmarks/clear': 'Очистить',\n\t\t\t\t'sidebar/annotations': 'Аннотации',\n\t\t\t\t'sidebar/annotations/add': 'Добавить',\n\t\t\t\t'sidebar/annotations/clear': 'Очистить',\n\t\t\t\t'sidebar/annotations/anchor': 'Метка',\n\t\t\t\t'sidebar/annotations/cancel': 'Отмена',\n\t\t\t\t'sidebar/search': 'Поиск',\n\t\t\t\t'sidebar/search/placeholder': 'поиск...',\n\t\t\t\t'sidebar/settings': 'Настройки',\n\t\t\t\t'sidebar/settings/language': 'Язык',\n\t\t\t\t'sidebar/settings/fontsize': 'Размер шрифта',\n\t\t\t\t'sidebar/settings/layout': 'Макет',\n\t\t\t\t'sidebar/settings/pagination': ['Нумерация страниц', 'Генерировать нумерацию страниц'],\n\t\t\t\t'sidebar/settings/spread': 'Разворот',\n\t\t\t\t'sidebar/settings/spread/pagewidth': 'Ширина страницы'\n\t\t\t}\n\t\t};\n\t}\n\n\tget(key) { return this.values[this.language][key] || '???'; }\n}\n","import EventEmitter from \"event-emitter\";\n\nimport { Toolbar } from './toolbar.js';\nimport { Sidebar } from './sidebar.js';\nimport { Content } from './content.js';\nimport { Strings } from './strings.js';\n\nexport class Reader {\n\n\tconstructor(bookPath, _options) {\n\n\t\tthis.settings = undefined;\n\t\tthis.cfgInit(bookPath, _options);\n\n\t\tthis.strings = new Strings(this);\n\t\tthis.toolbar = new Toolbar(this);\n\t\tthis.sidebar = new Sidebar(this);\n\t\tthis.content = new Content(this);\n\n\t\tthis.book = undefined;\n\t\tthis.rendition = undefined;\n\t\tthis.displayed = undefined;\n\n\t\tthis.init();\n\n\t\twindow.addEventListener('beforeunload', this.unload.bind(this), false);\n\t\twindow.addEventListener('hashchange', this.hashChanged.bind(this), false);\n\t\twindow.addEventListener('keydown', this.keyboardHandler.bind(this), false);\n\t\twindow.addEventListener('wheel', (e) => {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}, { passive: false });\n\t}\n\n\t/**\n\t * Initialize book.\n\t * @param {*} bookPath\n\t * @param {*} _options\n\t */\n\tinit(bookPath, _options) {\n\n\t\tthis.emit('viewercleanup');\n\n\t\tif (arguments.length > 0) {\n\n\t\t\tthis.cfgInit(bookPath, _options);\n\t\t}\n\n\t\tthis.book = ePub(this.settings.bookPath);\n\t\tthis.rendition = this.book.renderTo('viewer', {\n\t\t\tflow: this.settings.flow || \"paginated\",\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\"\n\t\t});\n\n\t\tconst cfi = this.settings.previousLocationCfi;\n\t\tif (cfi) {\n\t\t\tthis.displayed = this.rendition.display(cfi);\n\t\t} else {\n\t\t\tthis.displayed = this.rendition.display();\n\t\t}\n\n\t\tthis.displayed.then((renderer) => {\n\t\t\tthis.emit('renderered', renderer);\n\t\t});\n\n\t\tthis.book.ready.then(function () {\n\t\t\tthis.emit(\"bookready\");\n\t\t\tthis.emit(\"layoutchanged\", this.settings.flow);\n\t\t\tthis.emit(\"spreadchanged\", this.settings.spread);\n\t\t\tthis.emit(\"styleschanged\", this.settings.styles);\n\t\t}.bind(this)).then(function () {\n\t\t\tthis.emit('bookloaded');\n\t\t}.bind(this));\n\n\t\tthis.book.loaded.metadata.then((meta) => {\n\t\t\tthis.emit('metadata', meta);\n\t\t});\n\n\t\tthis.book.loaded.navigation.then((toc) => {\n\t\t\tthis.emit('navigation', toc);\n\t\t});\n\n\t\tthis.rendition.on('click', (e) => {\n\t\t\tconst selection = e.view.document.getSelection();\n\t\t\tconst range = selection.getRangeAt(0);\n\t\t\tif (range.startOffset === range.endOffset) {\n\t\t\t\tthis.emit('unselected');\n\t\t\t}\n\t\t});\n\n\t\tthis.rendition.on('layout', (props) => {\n\t\t\tthis.emit('layout', props);\n\t\t});\n\n\t\tthis.rendition.on('selected', (cfiRange, contents) => {\n\t\t\tthis.setLocation(cfiRange);\n\t\t\tthis.emit('selected', cfiRange, contents);\n\t\t});\n\n\t\tthis.rendition.on('relocated', (location) => {\n\t\t\tthis.setLocation(location.start.cfi);\n\t\t\tthis.emit('relocated', location);\n\t\t});\n\n\t\tthis.on('prev', () => {\n\t\t\tif (this.book.package.metadata.direction === 'rtl') {\n\t\t\t\tthis.rendition.next();\n\t\t\t} else {\n\t\t\t\tthis.rendition.prev();\n\t\t\t}\n\t\t});\n\n\t\tthis.on('next', () => {\n\t\t\tif (this.book.package.metadata.direction === 'rtl') {\n\t\t\t\tthis.rendition.prev();\n\t\t\t} else {\n\t\t\t\tthis.rendition.next();\n\t\t\t}\n\t\t});\n\n\t\tthis.on('tocselected', (sectionId) => {\n\t\t\tthis.settings.sectionId = sectionId;\n\t\t});\n\n\t\tthis.on(\"layoutchanged\", (value) => {\n\t\t\tthis.settings.flow = value;\n\t\t\tthis.rendition.flow(value);\n\t\t});\n\t\t\n\t\tthis.on(\"spreadchanged\", (value) => {\n\t\t\tconst mod = value[\"mod\"];\n\t\t\tconst min = value[\"min\"];\n\t\t\tthis.settings.spread[\"mod\"] = mod;\n\t\t\tthis.settings.spread[\"min\"] = min;\n\t\t\tthis.rendition.spread(mod, min);\n\t\t});\n\n\t\tthis.on(\"styleschanged\", (value) => {\n\t\t\tconst fontSize = value[\"fontSize\"];\n\t\t\tthis.settings.styles.fontSize = fontSize;\n\t\t\tthis.rendition.themes.fontSize(fontSize + \"%\");\n\t\t});\n\t}\n\n\t/* ------------------------------- Common ------------------------------- */\n\n\tdefaults(obj) {\n\n\t\tfor (let i = 1, length = arguments.length; i < length; i++) {\n\t\t\tconst source = arguments[i];\n\t\t\tfor (let prop in source) {\n\t\t\t\tif (obj[prop] === void 0)\n\t\t\t\t\tobj[prop] = source[prop];\n\t\t\t}\n\t\t}\n\t\treturn obj;\n\t}\n\n\tuuid() {\n\n\t\tlet d = new Date().getTime();\n\t\tconst uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n\t\t\tlet r = (d + Math.random() * 16) % 16 | 0;\n\t\t\td = Math.floor(d / 16);\n\t\t\treturn (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n\t\t});\n\t\treturn uuid;\n\t}\n\n\t/* ------------------------------ Bookmarks ----------------------------- */\n\n\t/**\n\t * Verifying the current page in bookmarks.\n\t * @param {*} cfi\n\t * @returns The index of the bookmark if it exists, or -1 otherwise.\n\t */\n\tisBookmarked(cfi) {\n\n\t\treturn this.settings.bookmarks.indexOf(cfi);\n\t}\n\n\t/* ----------------------------- Annotations ---------------------------- */\n\n\tisAnnotated(note) {\n\n\t\treturn this.settings.annotations.indexOf(note);\n\t}\n\n\t/* ------------------------------ Settings ------------------------------ */\n\n\t/**\n\t * Initialize book settings.\n\t * @param {*} bookPath\n\t * @param {*} _options\n\t */\n\tcfgInit(bookPath, _options) {\n\n\t\tthis.settings = this.defaults(_options || {}, {\n\t\t\tbookKey: this.getBookKey(bookPath),\n\t\t\tbookPath: bookPath,\n\t\t\tflow: undefined,\n\t\t\trestore: false,\n\t\t\thistory: true,\n\t\t\treload: false, // ??\n\t\t\tbookmarks: undefined,\n\t\t\tannotations: undefined,\n\t\t\tcontained: undefined,\n\t\t\tsectionId: undefined,\n\t\t\tspread: undefined,\n\t\t\tstyles: undefined,\n\t\t\tpagination: false, // ??\n\t\t\tlanguage: undefined\n\t\t});\n\n\t\tif (this.settings.restore && this.isSaved()) {\n\t\t\tthis.applySavedSettings();\n\t\t}\n\n\t\tif (this.settings.bookmarks === undefined) {\n\t\t\tthis.settings.bookmarks = [];\n\t\t}\n\n\t\tif (this.settings.annotations === undefined) {\n\t\t\tthis.settings.annotations = [];\n\t\t}\n\n\t\tif (this.settings.flow === undefined) {\n\t\t\tthis.settings.flow = \"paginated\";\n\t\t}\n\n\t\tif (this.settings.spread === undefined) {\n\t\t\tthis.settings.spread = {\n\t\t\t\tmod: \"auto\",\n\t\t\t\tmin: 800\n\t\t\t};\n\t\t}\n\n\t\tif (this.settings.styles === undefined) {\n\t\t\tthis.settings.styles = {\n\t\t\t\tfontSize: 100\n\t\t\t};\n\t\t}\n\n\t\tif (this.settings.language === undefined) {\n\t\t\tthis.settings.language = 'en';\n\t\t}\n\t}\n\n\t/**\n\t * Get book key.\n\t * @param {*} identifier (url | blob)\n\t * @returns Book key (MD5).\n\t */\n\tgetBookKey(identifier) {\n\n\t\treturn 'epubjs-reader:' + md5(identifier);\n\t}\n\n\t/**\n\t * Set book key in settings.\n\t * @param {*} identifier (url | blob)\n\t * @returns Current book key.\n\t */\n\tsetBookKey(identifier) {\n\n\t\tif (this.settings.bookKey === undefined) {\n\t\t\tthis.settings.bookKey = this.getBookKey(identifier);\n\t\t}\n\t\treturn this.settings.bookKey;\n\t}\n\n\t/**\n\t * Checks if the book setting can be retrieved from localStorage.\n\t * @returns true if the book key exists, or false otherwise.\n\t */\n\tisSaved() {\n\n\t\tif (!localStorage)\n\t\t\treturn false;\n\n\t\treturn localStorage.getItem(this.settings.bookKey) !== null;\n\t}\n\n\t/**\n\t * Removing the current book settings from local storage.\n\t * @returns true if the book settings were deleted successfully, or false\n\t * otherwise.\n\t */\n\tremoveSavedSettings() {\n\n\t\tif (!this.isSaved())\n\t\t\treturn false;\n\n\t\tlocalStorage.removeItem(this.settings.bookKey);\n\t\treturn true;\n\t}\n\n\tapplySavedSettings() {\n\n\t\tif (!localStorage)\n\t\t\treturn false;\n\n\t\tlet stored;\n\t\ttry {\n\t\t\tstored = JSON.parse(localStorage.getItem(this.settings.bookKey));\n\t\t} catch (e) { // parsing error of localStorage\n\t\t\tconsole.exception(e);\n\t\t}\n\n\t\tif (stored) {\n\t\t\t// Merge spread\n\t\t\tif (stored.spread) {\n\t\t\t\tthis.settings.spread = this.defaults(this.settings.spread || {}, \n\t\t\t\t\tstored.spread);\n\t\t\t}\n\t\t\t// Merge styles\n\t\t\tif (stored.styles) {\n\t\t\t\tthis.settings.styles = this.defaults(this.settings.styles || {},\n\t\t\t\t\tstored.styles);\n\t\t\t}\n\t\t\t// Merge the rest\n\t\t\tthis.settings = this.defaults(this.settings, stored);\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Saving the current book settings in local storage.\n\t * @returns\n\t */\n\tsaveSettings() {\n\n\t\tif (this.book) {\n\n\t\t\tif (this.rendition.location) {\n\t\t\t\tconst curLocation = this.rendition.currentLocation();\n\t\t\t\tthis.settings.previousLocationCfi = curLocation.start.cfi;\n\t\t\t}\n\t\t}\n\n\t\tif (!localStorage)\n\t\t\treturn false;\n\n\t\tlocalStorage.setItem(this.settings.bookKey, JSON.stringify(this.settings));\n\t\treturn true;\n\t}\n\n\tunload() {\n\n\t\tif (this.settings.restore && localStorage) {\n\t\t\tthis.saveSettings();\n\t\t}\n\t}\n\n\thashChanged() {\n\n\t\tconst hash = window.location.hash.slice(1);\n\t\tthis.rendition.display(hash);\n\t}\n\n\tsetLocation(cfi) {\n\n\t\tconst baseUrl = this.book.archived ? undefined : this.book.url;\n\t\tconst url = new URL(window.location, baseUrl);\n\t\turl.hash = \"#\" + cfi;\n\n\t\t// Update the History Location\n\t\tif (this.settings.history && window.location.hash !== url.hash) {\n\t\t\t// Add CFI fragment to the history\n\t\t\twindow.history.pushState({}, \"\", url);\n\t\t\tthis.currentLocationCfi = cfi;\n\t\t}\n\t}\n\n\tgeneratePagination() {\n\t\t//\n\t\t// no implemented\n\t\t//\n\t\t//const rect = this.content.viewer.getRect();\n\t\t//this.book.generatePagination(rect.width, rect.height);\n\t}\n\n\tkeyboardHandler(e) {\n\n\t\tconst MOD = (e.ctrlKey || e.metaKey);\n\n\t\tif (MOD) {\n\n\t\t\tconst step = 2;\n\t\t\tlet value = this.settings.styles.fontSize;\n\n\t\t\tswitch (e.key) {\n\n\t\t\t\tcase '=':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue += step;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t\tcase '-':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue -= step;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t\tcase '0':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue = 100;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\tthis.emit('prev');\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\tthis.emit('next');\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nEventEmitter(Reader.prototype);\n","export class Storage {\n\n\tconstructor() {\n\n\t\tthis.name = 'epubjs-reader';\n\t\tthis.version = 1.0;\n\t\tthis.database;\n\t\tthis.indexedDB = window.indexedDB ||\n\t\t\twindow.webkitIndexedDB ||\n\t\t\twindow.mozIndexedDB ||\n\t\t\twindow.OIndexedDB ||\n\t\t\twindow.msIndexedDB;\n\n\t\tif (this.indexedDB === undefined) {\n\n\t\t\talert('The IndexedDB API not available in your browser.');\n\t\t}\n\t}\n\n\tinit(callback) {\n\n\t\tif (this.indexedDB === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst scope = this;\n\t\tconst request = indexedDB.open(this.name, this.version);\n\t\trequest.onupgradeneeded = function (event) {\n\n\t\t\tconst db = event.target.result;\n\t\t\tif (db.objectStoreNames.contains('entries') === false) {\n\n\t\t\t\tdb.createObjectStore(\"entries\");\n\t\t\t}\n\t\t};\n\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tscope.database = event.target.result;\n\t\t\tscope.database.onerror = function (event) {\n\n\t\t\t\tconsole.error('IndexedDB', event);\n\t\t\t};\n\t\t\tcallback();\n\t\t}\n\n\t\trequest.onerror = function (event) {\n\n\t\t\tconsole.error('IndexedDB', event);\n\t\t};\n\t}\n\n\tget(callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.get(0);\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tcallback(event.target.result);\n\t\t\tconsole.log('storage.get');\n\t\t};\n\t}\n\n\tset(data, callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.put(data, 0);\n\t\trequest.onsuccess = function () {\n\n\t\t\tcallback();\n\t\t\tconsole.log('storage.set');\n\t\t};\n\t}\n\n\tclear() {\n\n\t\tif (this.database === undefined)\n\t\t\treturn;\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.clear();\n\t\trequest.onsuccess = function () {\n\n\t\t\tconsole.log('storage.clear');\n\t\t};\n\t}\n}\n","import { Reader } from './reader.js';\nimport { Storage } from './storage.js';\n\n\"use strict\";\n\nwindow.ResizeObserver = undefined;\nwindow.onload = function () {\n\n\tconst storage = new Storage();\n\tconst url = new URL(window.location);\n\tconst path = url.search.length > 0\n\t\t? url.searchParams.get(\"bookPath\")\n\t\t: \"https://s3.amazonaws.com/moby-dick/\";\n\n\tstorage.init(function () {\n\n\t\tstorage.get(function (data) {\n\n\t\t\tif (data !== undefined && url.search.length === 0) {\n\n\t\t\t\twindow.reader = new Reader(data, { restore: true });\n\n\t\t\t} else {\n\n\t\t\t\twindow.reader = new Reader(path, { restore: true });\n\t\t\t}\n\t\t});\n\t});\n\n\twindow.storage = storage;\n};\n"],"names":["isValue","isPlainFunction","assign","normalizeOpts","contains","module","exports","dscr","value","c","e","w","options","desc","arguments","length","call","configurable","enumerable","writable","gs","get","set","undefined","Object","obj","foo","bar","trzy","keys","max","Math","dest","src","error","i","key","forEach","_undefined","val","object","Array","prototype","create","opts1","result","process","fn","TypeError","String","str","indexOf","searchString","this","on","once","off","emit","methods","descriptors","base","d","callable","apply","Function","defineProperty","defineProperties","hasOwnProperty","descriptor","type","listener","self","__eeOnceListener__","data","__ee__","push","listeners","candidate","splice","l","args","slice","o","isPrototype","possibleTypes","isFunction","classRe","functionToString","toString","test","isObject","constructor","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","a","definition","prop","errormsg","UIElement","dom","add","argument","appendChild","isArray","j","element","console","remove","removeChild","clear","children","lastChild","setId","id","getId","setClass","name","className","addClass","classList","removeClass","setStyle","style","array","setDisabled","disabled","setTextContent","textContent","getRect","getBoundingClientRect","property","method","substr","toUpperCase","event","callback","addEventListener","toLowerCase","bind","UISpan","super","document","createElement","UIDiv","UIRow","UIPanel","UILabel","text","htmlFor","UIText","setValue","getValue","UILink","uri","label","href","UIInput","title","stopPropagation","setTitle","getName","setName","getType","setType","getTitle","readonly","readOnly","UITextArea","spellcheck","keyCode","preventDefault","cursor","selectionStart","substring","selectionEnd","UISelect","setMultiple","boolean","multiple","setOptions","selected","firstChild","option","innerHTML","UIInteger","step","min","UITabbedPanel","align","tabs","panels","selector","tabsDiv","panelsDiv","select","tab","panel","find","item","setDisplay","size","rect","width","transform","height","addTab","items","UITab","parent","button","UITreeView","UITreeViewItem","link","toggle","expander","expanded","setItems","subItems","onclick","collaps","expand","getElementsByTagName","unselect","removeAttribute","display","MetadataPanel","reader","creator","separator","meta","init","Toolbar","strings","container","start","opener","openerStr","isOpen","center","end","open","uploadStr","storage","window","accept","target","files","FileReader","fr","onload","unload","restore","readAsArrayBuffer","onerror","location","includes","origin","pathname","alert","bookmark","bookmarkStr","cfi","rendition","currentLocation","isBookmarked","fullscreenEnabled","fullscreen","fullscreenStr","toggleFullScreen","screen","clientWidth","h","clientHeight","body","activeElement","blur","fullscreenElement","documentElement","requestFullscreen","exitFullscreen","TocPanel","toc","generateToc","chapter","treeItem","settings","sectionId","subitems","BookmarksPanel","ctrlRow","ctrlStr","btn_a","btn_r","btn_c","clearBookmarks","bookmarks","update","createBookmarkItem","addBookmark","removeBookmark","index","childNodes","hasChildNodes","book","spineItem","spine","navigation","tocItem","AnnotationsPanel","notes","textBox","isSelected","range","cfiRange","textRow","note","date","Date","uuid","annotations","clearNotes","startOffset","endOffset","contents","btnr","len","SearchPanel","searchQuery","searchBox","placeholder","onsearch","doSearch","then","results","q","Promise","all","spineItems","map","load","finally","resolve","concat","excerpt","SettingsPanel","languageStr","languageRow","language","en","ja","ru","onchange","fontSizeStr","fontSizeRow","fontSize","parseInt","layoutStr","layoutRow","layout","paginated","scrolled","mod","spread","spreadStr","spreadRow","none","auto","minSpreadWidthStr","minSpreadWidthRow","minSpreadWidth","paginationStr","paginationRow","pagination","checked","generatePagination","props","Sidebar","Content","main","sidebarReflow","resize","prev","next","viewer","divider","loader","showDivider","spreads","slideOut","slideIn","spreadWidth","atStart","atEnd","setTimeout","Strings","values","Reader","bookPath","_options","cfgInit","toolbar","sidebar","content","displayed","hashChanged","keyboardHandler","ctrlKey","passive","ePub","renderTo","flow","previousLocationCfi","renderer","ready","styles","loaded","metadata","view","getSelection","getRangeAt","setLocation","package","direction","themes","defaults","source","getTime","replace","r","random","floor","isAnnotated","bookKey","getBookKey","history","reload","contained","isSaved","applySavedSettings","identifier","md5","setBookKey","localStorage","getItem","removeSavedSettings","removeItem","stored","JSON","parse","exception","saveSettings","curLocation","setItem","stringify","hash","baseUrl","archived","url","URL","pushState","currentLocationCfi","metaKey","Storage","version","database","indexedDB","webkitIndexedDB","mozIndexedDB","OIndexedDB","msIndexedDB","scope","request","onupgradeneeded","db","objectStoreNames","createObjectStore","onsuccess","transaction","objectStore","log","put","ResizeObserver","path","search","searchParams"],"sourceRoot":""}