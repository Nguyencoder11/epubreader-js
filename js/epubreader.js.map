{"version":3,"file":"js/epubreader.min.js","mappings":"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","sources":["webpack://epubjs-reader/./node_modules/d/index.js","webpack://epubjs-reader/./node_modules/es5-ext/function/noop.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/index.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/object/assign/shim.js","webpack://epubjs-reader/./node_modules/es5-ext/object/is-value.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/index.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/object/keys/shim.js","webpack://epubjs-reader/./node_modules/es5-ext/object/normalize-options.js","webpack://epubjs-reader/./node_modules/es5-ext/object/valid-callable.js","webpack://epubjs-reader/./node_modules/es5-ext/object/valid-value.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/index.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/is-implemented.js","webpack://epubjs-reader/./node_modules/es5-ext/string/\u0000#/contains/shim.js","webpack://epubjs-reader/./node_modules/event-emitter/index.js","webpack://epubjs-reader/./node_modules/type/function/is.js","webpack://epubjs-reader/./node_modules/type/object/is.js","webpack://epubjs-reader/./node_modules/type/plain-function/is.js","webpack://epubjs-reader/./node_modules/type/prototype/is.js","webpack://epubjs-reader/./node_modules/type/value/is.js","webpack://epubjs-reader/webpack/bootstrap","webpack://epubjs-reader/webpack/runtime/compat get default export","webpack://epubjs-reader/webpack/runtime/define property getters","webpack://epubjs-reader/webpack/runtime/hasOwnProperty shorthand","webpack://epubjs-reader/./src/ui.js","webpack://epubjs-reader/./src/toolbar/metadata.js","webpack://epubjs-reader/./src/toolbar.js","webpack://epubjs-reader/./src/sidebar/toc.js","webpack://epubjs-reader/./src/sidebar/bookmarks.js","webpack://epubjs-reader/./src/sidebar/annotations.js","webpack://epubjs-reader/./src/sidebar/search.js","webpack://epubjs-reader/./src/sidebar/settings.js","webpack://epubjs-reader/./src/sidebar.js","webpack://epubjs-reader/./src/content.js","webpack://epubjs-reader/./src/strings.js","webpack://epubjs-reader/./src/reader.js","webpack://epubjs-reader/./src/storage.js","webpack://epubjs-reader/./src/main.js"],"sourcesContent":["\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * @author mrdoob https://github.com/mrdoob/ui.js\n */\n\nconst ERROR_MSG = \"is not an instance of UIElement.\";\n\n/**\n * UIElement\n * @param {string} tag\n */\nexport class UIElement {\n\t\n\tconstructor(tag) {\n\n\t\tthis.dom = document.createElement(tag); \n\t}\n\n\tadd() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.appendChild(argument.dom);\n\n\t\t\t} else if (Array.isArray(argument)) {\n\n\t\t\t\tfor (let j = 0; j < argument.length; j++) {\n\n\t\t\t\t\tconst element = argument[j];\n\n\t\t\t\t\tif (element instanceof UIElement) {\n\n\t\t\t\t\t\tthis.dom.appendChild(element.dom);\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.error(\"UIElement:\", element, ERROR_MSG);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tconsole.error(\"UIElement:\", argument, ERROR_MSG);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tremove() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\n\t\t\tconst argument = arguments[i];\n\n\t\t\tif (argument instanceof UIElement) {\n\n\t\t\t\tthis.dom.removeChild(argument.dom);\n\n\t\t\t} else if (Number.isInteger(argument)) {\n\n\t\t\t\tthis.dom.removeChild(this.dom.childNodes[argument]);\n\t\t\t} else {\n\n\t\t\t\tconsole.error(\"UIElement:\", argument, ERROR_MSG);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclear() {\n\n\t\twhile (this.dom.children.length) {\n\n\t\t\tthis.dom.removeChild(this.dom.lastChild);\n\t\t}\n\t\treturn this;\n\t}\n\n\tsetId(id) {\n\n\t\tthis.dom.id = id;\n\t\treturn this;\n\t}\n\n\tgetId() {\n\n\t\treturn this.dom.id;\n\t}\n\n\tsetClass(name) {\n\n\t\tthis.dom.className = name;\n\t\treturn this;\n\t}\n\n\taddClass(name) {\n\n\t\tthis.dom.classList.add(name);\n\t\treturn this;\n\t}\n\n\tremoveClass(name) {\n\n\t\tthis.dom.classList.remove(name);\n\t\treturn this;\n\t}\n\n\tsetStyle(key, value) {\n\n\t\tthis.dom.style[key] = value;\n\t\treturn this;\n\t}\n\n\tsetTextContent(text) {\n\n\t\tthis.dom.textContent = text;\n\t\treturn this;\n\t}\n\n\tgetBoundingClientRect() {\n\n\t\treturn this.dom.getBoundingClientRect();\n\t}\n}\n\n/**\n * UISpan\n */\nexport class UISpan extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"span\");\n\t}\n}\n\n/**\n * UIDiv\n */\nexport class UIDiv extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"div\");\n\t}\n}\n\n/**\n * UIRow\n */\nexport class UIRow extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.dom.className = \"row\";\n\t}\n}\n\n/**\n * UIPanel\n */\nexport class UIPanel extends UIDiv {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.dom.className = \"panel\";\n\t}\n}\n\n/**\n * UILabel\n * @param {string} text\n * @param {string} id\n */\nexport class UILabel extends UIElement {\n\n\tconstructor(text, id) {\n\n\t\tsuper(\"label\");\n\n\t\tthis.dom.textContent = text;\n\t\tif (id) this.dom.htmlFor = id;\n\t}\n}\n\n/**\n * UILink\n * @param {string} href\n * @param {string} text\n */\nexport class UILink extends UIElement {\n\n\tconstructor(href, text) {\n\n\t\tsuper(\"a\");\n\n\t\tthis.dom.href = href || \"#\";\n\t\tthis.dom.textContent = text || \"\";\n\t}\n\n\tsetHref(url) {\n\n\t\tthis.dom.href = url;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIText\n * @param {string} text\n */\nexport class UIText extends UISpan {\n\n\tconstructor(text) {\n\n\t\tsuper();\n\n\t\tthis.dom.textContent = text;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.textContent;\n\t}\n\n\tsetValue(text) {\n\n\t\tthis.dom.textContent = text;\n\t\treturn this;\n\t}\n}\n\n/**\n * UITextArea\n */\nexport class UITextArea extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"textarea\");\n\n\t\tthis.dom.spellcheck = false;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\n\t\t\tif (e.key === \"Tab\") {\n\n\t\t\t\tconst cursor = this.dom.selectionStart;\n\t\t\t\tthis.dom.value = this.dom.value.substring(0, cursor) + \"\\t\" + this.dom.value.substring(cursor);\n\t\t\t\tthis.dom.selectionStart = cursor + 1;\n\t\t\t\tthis.dom.selectionEnd = this.dom.selectionStart;\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UISelect\n */\nexport class UISelect extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"select\");\n\t}\n\n\tsetMultiple(boolean) {\n\n\t\tthis.dom.multiple = boolean || false;\n\t\treturn this;\n\t}\n\n\tsetOptions(options) {\n\n\t\tconst selected = this.dom.value;\n\t\tthis.clear();\n\n\t\tfor (const key in options) {\n\n\t\t\tconst option = document.createElement(\"option\");\n\t\t\toption.value = key;\n\t\t\toption.text = options[key];\n\t\t\tthis.dom.appendChild(option);\n\t\t}\n\t\tthis.dom.value = selected;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tvalue = String(value);\n\n\t\tif (this.dom.value !== value)\n\t\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIInput\n * @param {*} type\n * @param {*} value\n * @param {*} title\n */\nexport class UIInput extends UIElement {\n\n\tconstructor(type, value, title) {\n\n\t\tsuper(\"input\");\n\n\t\tthis.dom.type = type;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\t\t};\n\t\tthis.setValue(value);\n\t\tthis.setTitle(title);\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tgetTitle() {\n\n\t\treturn this.dom.title;\n\t}\n\n\tsetTitle(title) {\n\n\t\tif (this.dom.title !== title && title)\n\t\t\tthis.dom.title = title;\n\t\treturn this;\n\t}\n\n\tgetType() {\n\n\t\treturn this.dom.type;\n\t}\n\n\tsetType(type) {\n\n\t\tthis.dom.type = type;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tsetValue(value) {\n\n\t\tif (this.dom.value !== value && value)\n\t\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UIColor\n */\nexport class UIColor extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"input\");\n\n\t\ttry {\n\n\t\t\tthis.dom.type = \"color\";\n\t\t\tthis.dom.value = \"#ffffff\";\n\n\t\t} catch (e) {\n\n\t\t\tconsole.exception(e);\n\t\t}\n\t}\n\n\tgetValue() {\n\n\t\treturn this.dom.value;\n\t}\n\n\tgetHexValue() {\n\n\t\treturn parseInt(this.dom.value.substr(1), 16);\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n\n\tsetHexValue(hex) {\n\n\t\tthis.dom.value = \"#\" + (\"000000\" + hex.toString(16)).slice(-6);\n\t\treturn this;\n\t}\n}\n\n/**\n * UINumber\n * @param {number} value\n * @param {number} step\n * @param {number} min\n * @param {number} max\n * @param {number} precision\n */\nexport class UINumber extends UIElement {\n\n\tconstructor(value, step, min, max, precision) {\n\n\t\tsuper(\"input\");\n\n\t\tthis.dom.type = \"number\";\n\t\tthis.dom.step = step || 1;\n\t\tthis.dom.onkeydown = (e) => {\n\n\t\t\te.stopPropagation();\n\t\t};\n\t\tthis.value = value || 0;\n\t\tthis.min = min || -Infinity;\n\t\tthis.max = max || +Infinity;\n\t\tthis.precision = precision || 0;\n\t\tthis.setValue(value);\n\t\tthis.dom.onchange = (e) => {\n\n\t\t\tthis.setValue(this.value);\n\t\t};\n\t}\n\n\tgetName() {\n\n\t\treturn this.dom.name;\n\t}\n\n\tsetName(name) {\n\n\t\tthis.dom.name = name;\n\t\treturn this;\n\t}\n\n\tsetPrecision(precision) {\n\n\t\tthis.precision = precision;\n\t\tthis.setValue(this.value);\n\t\treturn this;\n\t}\n\n\tsetRange(min, max) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\t\tthis.dom.min = min;\n\t\tthis.dom.max = max;\n\t\treturn this;\n\t}\n\n\tsetStep(step) {\n\n\t\tthis.dom.step = step;\n\t\treturn this;\n\t}\n\n\tsetTitle(text) {\n\n\t\tthis.dom.title = text;\n\t\treturn this;\n\t}\n\n\tgetValue() {\n\n\t\treturn parseFloat(this.dom.value);\n\t}\n\n\tsetValue(value) {\n\n\t\tif (value !== undefined) {\n\t\t\tvalue = parseFloat(value);\n\n\t\t\tif (value < this.min)\n\t\t\t\tvalue = this.min;\n\t\t\tif (value > this.max)\n\t\t\t\tvalue = this.max;\n\n\t\t\tthis.value = value;\n\t\t\tthis.dom.value = value.toFixed(this.precision);\n\t\t}\n\t\treturn this;\n\t}\n}\n\n/**\n * UIBreak\n */\nexport class UIBreak extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"br\");\n\t}\n}\n\n/**\n * UIHorizontalRule\n */\nexport class UIHorizontalRule extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"hr\");\n\t}\n}\n\n/**\n * UIProgress\n * @param {*} value\n */\nexport class UIProgress extends UIElement {\n\n\tconstructor(value) {\n\n\t\tsuper(\"progress\");\n\n\t\tthis.dom.value = value;\n\t}\n\n\tsetValue(value) {\n\n\t\tthis.dom.value = value;\n\t\treturn this;\n\t}\n}\n\n/**\n * UITabbedPanel\n * @param {string} align (horizontal | vertical)\n */\nexport class UITabbedPanel extends UIDiv {\n\n\tconstructor(align) {\n\n\t\tsuper();\n\n\t\tthis.align = align || \"horizontal\";\n\t\tthis.tabs = [];\n\t\tthis.panels = [];\n\t\tthis.selector = new UISpan().setClass(\"tab-selector\");\n\t\tthis.tabsDiv = new UIDiv().setClass(\"tabs\");\n\t\tthis.tabsDiv.add(this.selector);\n\t\tthis.panelsDiv = new UIDiv().setClass(\"panels\");\n\t\tthis.selected = \"\";\n\t\tthis.add(this.tabsDiv);\n\t\tthis.add(this.panelsDiv);\n\t}\n\n\taddTab(id, label, items) {\n\n\t\tconst tab = new UITab(label, this);\n\t\ttab.setId(id);\n\t\ttab.setClass(\"tab\");\n\t\tthis.tabs.push(tab);\n\t\tthis.tabsDiv.add(tab);\n\n\t\tconst panel = new UIDiv();\n\t\tpanel.setId(id);\n\t\tpanel.add(items);\n\t\tthis.panels.push(panel);\n\t\tthis.panelsDiv.add(panel);\n\t\tthis.select(id);\n\t}\n\n\tselect(id) {\n\n\t\tfor (let tab of this.tabs) {\n\t\t\tif (tab.dom.id === id) {\n\t\t\t\ttab.addClass(\"selected\");\n\t\t\t\tthis.transformSelector(tab);\n\t\t\t} else if (tab.dom.id === this.selected) {\n\t\t\t\ttab.removeClass(\"selected\");\n\t\t\t}\n\t\t}\n\n\t\tfor (let panel of this.panels) {\n\t\t\tif (panel.dom.id === id) {\n\t\t\t\tpanel.dom.style.display = \"block\";\n\t\t\t} else if (panel.dom.id === this.selected) {\n\t\t\t\tpanel.dom.style.display = \"none\";\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = id;\n\t\treturn this;\n\t}\n\n\ttransformSelector(tab) {\n\n\t\tlet size;\n\t\tconst rect = tab.getBoundingClientRect();\n\t\tif (this.align === \"horizontal\") {\n\t\t\tsize = rect.width * this.tabs.indexOf(tab);\n\t\t\tthis.selector.dom.style.transform = `translateX(${size}px)`;\n\t\t} else {\n\t\t\tsize = rect.height * this.tabs.indexOf(tab);\n\t\t\tthis.selector.dom.style.transform = `translateY(${size}px)`;\n\t\t}\n\t}\n}\n\n/**\n * UITab\n * @param {*} label\n * @param {*} parent\n */\nexport class UITab extends UIDiv {\n\n\tconstructor(label, parent) {\n\n\t\tsuper();\n\t\tconst button = new UIInput(\"button\");\n\t\tbutton.dom.title = label;\n\t\tthis.dom.onclick = (e) => {\n\n\t\t\tparent.select(this.dom.id);\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.add(button);\n\t}\n}\n\n/**\n * UIList\n */\nexport class UIList extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"div\");\n\t\tthis.setClass(\"list-container\");\n\t\tthis.list = document.createElement(\"ul\");\n\t\tthis.dom.appendChild(this.list);\n\t}\n\n\tadd(item, id) {\n\n\t\tconst listItem = document.createElement(\"li\");\n\t\tlistItem.id = id;\n\t\tif (Array.isArray(item)) {\n\t\t\titem.forEach((i) => { listItem.appendChild(i.dom) });\n\t\t} else {\n\t\t\tlistItem.appendChild(item.dom);\n\t\t}\n\t\tthis.list.appendChild(listItem);\n\t\treturn this;\n\t}\n\n\tremove() {\n\n\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\tconst argument = arguments[i];\n\t\t\tif (argument instanceof UIElement) {\n\t\t\t\tthis.list.removeChild(argument.dom);\n\t\t\t} else if (Number.isInteger(argument)) {\n\t\t\t\tthis.list.removeChild(this.list.childNodes[argument]);\n\t\t\t} else {\n\t\t\t\tconsole.error(\"UIList:\", argument, ERROR_MSG);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclear() {\n\n\t\twhile (this.list.children.length)\n\t\t\tthis.list.removeChild(this.list.lastChild);\n\t\treturn this;\n\t}\n}\n\n/**\n * UITreeView\n */\nexport class UITreeView extends UIElement {\n\n\tconstructor() {\n\n\t\tsuper(\"ul\");\n\t}\n}\n\n/**\n * UITreeViewItem\n * @param {string} id\n * @param {UILink} link\n */\nexport class UITreeViewItem extends UIElement {\n\n\tconstructor(id, link) {\n\n\t\tsuper(\"li\");\n\n\t\tthis.dom.id = id;\n\t\tthis.link = link;\n\t\tthis.toggle = new UISpan().setClass(\"toggle-collapsed\");\n\t\tthis.expander = new UIDiv().setId(\"expander\");\n\t\tthis.expanded = false;\n\t\tthis.selected = false;\n\t\tthis.add([this.expander, this.link]);\n\t}\n\n\tsetItem(subItem) {\n\n\t\tthis.add(subItem);\n\t\tthis.toggle.dom.onclick = () => {\n\n\t\t\tif (this.expanded) {\n\t\t\t\tthis.collaps();\n\t\t\t} else {\n\t\t\t\tthis.expand();\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis.expander.add(this.toggle);\n\n\t\tif (!this.expanded) {\n\n\t\t\tconst items = subItem.dom.getElementsByTagName(\"li\");\n\t\t\tfor (let item of items) {\n\t\t\t\tif (item.className === \"selected\") {\n\t\t\t\t\tthis.expand();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tselect() {\n\n\t\tthis.selected = true;\n\t\tthis.setClass(\"selected\");\n\t}\n\n\tunselect() {\n\n\t\tthis.selected = false;\n\t\tthis.dom.removeAttribute(\"class\");\n\t}\n\n\texpand() {\n\n\t\tthis.toggle.setClass(\"toggle-expanded\");\n\t\tthis.dom.children[2].style.display = \"block\";\n\t\tthis.expanded = true;\n\t}\n\n\tcollaps() {\n\n\t\tthis.toggle.setClass(\"toggle-collapsed\");\n\t\tthis.dom.children[2].style.display = \"none\";\n\t\tthis.expanded = false;\n\t}\n}","import { UIPanel, UIText } from \"../ui.js\";\n\nexport class MetadataPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId(\"metadata\");\n\n\t\tconst title = new UIText().setId(\"book-title\");\n\t\tconst creator = new UIText().setId(\"book-creator\");\n\t\tconst separator = new UIText().setId(\"book-title-separator\");\n\n\t\tsuper.add([title, separator, creator]);\n\n\t\t//-- events --//\n\n\t\treader.on(\"metadata\", (meta) => {\n\n\t\t\tdocument.title = meta.title;\n\t\t\tdocument.title = meta.creator ? \" - \" + meta.creator : \"\";\n\t\t\ttitle.setValue(meta.title);\n\t\t\tif (meta.creator) {\n\t\t\t\tcreator.setValue(meta.creator);\n\t\t\t\tseparator.dom.style.display = \"inline-block\";\n\t\t\t}\n\t\t});\n\t}\n}\n","import { UIPanel, UIDiv, UIInput } from \"./ui.js\";\nimport { MetadataPanel } from \"./toolbar/metadata.js\";\n\nexport class Toolbar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\n\t\tconst container = new UIDiv().setId(\"toolbar\");\n\t\tconst keys = [\n\t\t\t\"toolbar/opener\",\n\t\t\t\"toolbar/openbook\",\n\t\t\t\"toolbar/openbook/error\",\n\t\t\t\"toolbar/bookmark\",\n\t\t\t\"toolbar/fullsceen\"\n\t\t];\n\n\t\tconst start = new UIPanel().setId(\"start\");\n\t\tconst opener = new UIInput(\"button\").setId(\"btn-s\");\n\t\topener.dom.title = strings.get(keys[0]);\n\t\topener.dom.onclick = () => {\n\n\t\t\tconst isOpen = opener.dom.classList.length > 0;\n\n\t\t\treader.emit(\"sidebaropener\", !isOpen);\n\n\t\t\tif (!isOpen) {\n\t\t\t\topener.addClass(\"open\");\n\t\t\t} else {\n\t\t\t\topener.removeClass(\"open\");\n\t\t\t}\n\t\t};\n\n\t\tstart.add(opener);\n\n\t\tconst onload = (e) => {\n\n\t\t\tstorage.clear();\n\t\t\tstorage.set(e.target.result, () => {\n\t\t\t\treader.unload();\n\t\t\t\treader.init(e.target.result, { restore: true });\n\t\t\t\tconst url = new URL(window.location.origin);\n\t\t\t\twindow.history.pushState({}, \"\", url);\n\t\t\t});\n\t\t};\n\t\tconst onerror = (e) => {\n\t\t\tconsole.error(e);\n\t\t};\n\t\tconst storage = window.storage;\n\t\tconst end = new UIPanel().setId(\"end\");\n\t\tconst openbook = new UIInput(\"file\").setId(\"btn-o\");\n\t\topenbook.dom.title = strings.get(keys[1]);\n\t\topenbook.dom.accept = \"application/epub+zip\";\n\t\topenbook.dom.onchange = (e) => {\n\n\t\t\tif (e.target.files.length === 0)\n\t\t\t\treturn;\n\n\t\t\tif (window.FileReader) {\n\n\t\t\t\tconst fr = new FileReader();\n\t\t\t\tfr.onload = onload;\n\t\t\t\tfr.readAsArrayBuffer(e.target.files[0]);\n\t\t\t\tfr.onerror = onerror;\n\t\t\t} else {\n\t\t\t\talert(strings.get(keys[2]));\n\t\t\t}\n\t\t};\n\n\t\tend.add(openbook);\n\n\t\tconst bookmark = new UIInput(\"button\").setId(\"btn-b\");\n\t\tbookmark.dom.title = strings.get(keys[3]);\n\t\tbookmark.dom.onclick = (e) => {\n\n\t\t\tconst cfi = this.locationCfi;\n\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\treader.emit(\"bookmarked\", val);\n\t\t};\n\n\t\tend.add(bookmark);\n\n\t\tlet fullscreen = null;\n\t\tif (document.fullscreenEnabled) {\n\n\t\t\tfullscreen = new UIInput(\"button\").setId(\"btn-f\");\n\t\t\tfullscreen.dom.title = strings.get(keys[4]);\n\t\t\tfullscreen.dom.onclick = (e) => {\n\n\t\t\t\tthis.toggleFullScreen();\n\t\t\t};\n\n\t\t\tdocument.onkeydown = (e) => {\n\n\t\t\t\tif (e.key === \"F11\") {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.toggleFullScreen();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdocument.onfullscreenchange = (e) => {\n\t\t\t\t\n\t\t\t\tconst w = window.screen.width === e.target.clientWidth;\n\t\t\t\tconst h = window.screen.height === e.target.clientHeight;\n\n\t\t\t\tif (w && h) {\n\t\t\t\t\tfullscreen.addClass(\"resize-small\");\n\t\t\t\t} else {\n\t\t\t\t\tfullscreen.removeClass(\"resize-small\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tend.add(fullscreen);\n\t\t}\n\n\t\tcontainer.add([start, new MetadataPanel(reader), end]);\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tconst cfi = location.start.cfi;\n\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\tif (val) {\n\t\t\t\tbookmark.removeClass(\"bookmarked\");\n\t\t\t} else {\n\t\t\t\tbookmark.addClass(\"bookmarked\");\n\t\t\t}\n\t\t\tthis.locationCfi = cfi; // save location cfi\n\t\t});\n\n\t\treader.on(\"bookmarked\", (boolean) => {\n\n\t\t\tif (boolean) {\n\t\t\t\tbookmark.addClass(\"bookmarked\");\n\t\t\t} else {\n\t\t\t\tbookmark.removeClass(\"bookmarked\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\topener.dom.title = strings.get(keys[0]);\n\t\t\topenbook.dom.title = strings.get(keys[1]);\n\t\t\tbookmark.dom.title = strings.get(keys[3]);\n\n\t\t\tif (fullscreen) {\n\t\t\t\tfullscreen.dom.title = strings.get(keys[4]);\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleFullScreen() {\n\n\t\tdocument.activeElement.blur();\n\n\t\tif (document.fullscreenElement === null) {\n\t\t\tdocument.documentElement.requestFullscreen();\n\t\t} else if (document.exitFullscreen) {\n\t\t\tdocument.exitFullscreen();\n\t\t}\n\t}\n}\n","import { UIPanel, UITreeView, UITreeViewItem, UILink, UIDiv } from \"../ui.js\";\n\nexport class TocPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\n\t\tthis.setId(\"contents\");\n\t\tthis.reader = reader;\n\t\tthis.selector = undefined; // save reference to selected tree item\n\t\tconst container = new UIDiv().setClass(\"list-container\");\n\n\t\t//-- events --//\n\n\t\treader.on(\"navigation\", (toc) => {\n\n\t\t\tcontainer.clear();\n\t\t\tcontainer.add(this.generateToc(toc));\n\t\t\tthis.add(container);\n\t\t});\n\t}\n\n\tgenerateToc(toc) {\n\n\t\tconst container = new UITreeView();\n\n\t\ttoc.forEach((chapter) => {\n\n\t\t\tconst link = new UILink(chapter.href, chapter.label);\n\t\t\tconst item = new UITreeViewItem(chapter.id, link);\n\n\t\t\tlink.dom.onclick = () => {\n\n\t\t\t\tif (this.selector && this.selector !== item) {\n\t\t\t\t\tthis.selector.unselect();\n\t\t\t\t}\n\t\t\t\titem.select();\n\t\t\t\tthis.selector = item;\n\t\t\t\tthis.reader.emit(\"tocselected\", chapter);\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tif (this.reader.settings.sectionId === chapter.id) {\n\t\t\t\titem.select();\n\t\t\t\tthis.selector = item;\n\t\t\t}\n\n\t\t\tif (chapter.subitems && chapter.subitems.length > 0) {\n\n\t\t\t\titem.setItem(this.generateToc(chapter.subitems));\n\t\t\t}\n\n\t\t\tcontainer.add(item);\n\t\t});\n\n\t\treturn container;\n\t}\n}\n","import { UIPanel, UIRow, UIInput, UILink, UIList } from \"../ui.js\";\n\nexport class BookmarksPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\n\t\tconst strings = reader.strings;\n\n\t\tconst ctrlRow = new UIRow();\n\t\tconst ctrlStr = [\n\t\t\tstrings.get(\"sidebar/bookmarks/add\"),\n\t\t\tstrings.get(\"sidebar/bookmarks/remove\"),\n\t\t\tstrings.get(\"sidebar/bookmarks/clear\"),\n\t\t];\n\t\tconst btn_a = new UIInput(\"button\", ctrlStr[0]).addClass(\"btn-start\");\n\t\tconst btn_r = new UIInput(\"button\", ctrlStr[1]).addClass(\"btn-medium\");\n\t\tconst btn_c = new UIInput(\"button\", ctrlStr[2]).addClass(\"btn-end\");\n\n\t\tbtn_a.dom.onclick = () => {\n\n\t\t\treader.emit(\"bookmarked\", true);\n\t\t\treturn false;\n\t\t};\n\n\t\tbtn_r.dom.onclick = () => {\n\n\t\t\treader.emit(\"bookmarked\", false);\n\t\t\treturn false;\n\t\t};\n\n\t\tbtn_c.dom.onclick = () => {\n\n\t\t\tthis.clearBookmarks();\n\t\t\treader.emit(\"bookmarked\", false);\n\t\t\treturn false;\n\t\t};\n\n\t\tctrlRow.add([btn_a, btn_r, btn_c]);\n\n\t\tthis.reader = reader;\n\t\tthis.bookmarks = new UIList();\n\t\tthis.setId(\"bookmarks\");\n\t\tthis.add(ctrlRow);\n\t\tthis.add(this.bookmarks);\n\n\t\tconst update = () => {\n\n\t\t\tbtn_r.dom.disabled = reader.settings.bookmarks.length === 0;\n\t\t\tbtn_c.dom.disabled = reader.settings.bookmarks.length === 0;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tcfg.bookmarks.forEach((cfi) => {\n\n\t\t\t\tthis.setBookmark(cfi);\n\t\t\t});\n\t\t\tupdate();\n\t\t});\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tconst cfi = location.start.cfi;\n\t\t\tconst val = reader.isBookmarked(cfi) === -1;\n\t\t\tbtn_a.dom.disabled = !val;\n\t\t\tbtn_r.dom.disabled = val;\n\t\t\tthis.locationCfi = cfi; // save location cfi\n\t\t});\n\n\t\treader.on(\"bookmarked\", (boolean) => {\n\n\t\t\tif (boolean) {\n\t\t\t\tthis.appendBookmark();\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t} else {\n\t\t\t\tthis.removeBookmark();\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t}\n\t\t\tupdate();\n\t\t});\n\t}\n\n\tappendBookmark() {\n\n\t\tconst cfi = this.locationCfi;\n\t\tif (this.reader.isBookmarked(cfi) > -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setBookmark(cfi);\n\t\tthis.reader.settings.bookmarks.push(cfi);\n\t}\n\n\tremoveBookmark() {\n\n\t\tconst cfi = this.locationCfi;\n\t\tconst index = this.reader.isBookmarked(cfi);\n\t\tif (index === -1) {\n\t\t\treturn;\n\t\t}\n\t\tthis.bookmarks.remove(index);\n\t\tthis.reader.settings.bookmarks.splice(index, 1);\n\t}\n\n\tclearBookmarks() {\n\n\t\tthis.bookmarks.clear();\n\t\tthis.reader.settings.bookmarks = [];\n\t}\n\n\tsetBookmark(cfi) {\n\n\t\tconst link = new UILink();\n\t\tconst book = this.reader.book;\n\t\tconst spineItem = book.spine.get(cfi);\n\t\tconst navItem = book.navigation.get(spineItem.href);\n\t\tlet itemId;\n\n\t\tif (navItem === undefined) {\n\t\t\titemId = spineItem.idref;\n\t\t\tlink.setTextContent(spineItem.idref);\n\t\t} else {\n\t\t\titemId = navItem.id;\n\t\t\tlink.setTextContent(navItem.label);\n\t\t}\n\n\t\tlink.setHref(\"#\" + cfi);\n\t\tlink.dom.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(cfi);\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.bookmarks.add(link, itemId);\n\t}\n}\n","import { UIPanel, UIRow, UITextArea, UIInput, UILink, UIList, UISpan } from \"../ui.js\";\n\nexport class AnnotationsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\n\t\tconst strings = reader.strings;\n\t\tconst ctrlStr = [\n\t\t\tstrings.get(\"sidebar/annotations/add\"),\n\t\t\tstrings.get(\"sidebar/annotations/clear\")\n\t\t];\n\n\t\tconst textBox = new UITextArea();\n\t\ttextBox.dom.oninput = (e) => {\n\n\t\t\tif (isSelected() && e.target.value.length > 0) {\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t} else {\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t}\n\t\t};\n\n\t\tconst selector = {\n\t\t\trange: undefined,\n\t\t\tcfiRange: undefined\n\t\t};\n\n\t\tconst textRow = new UIRow();\n\t\tconst ctrlRow = new UIRow();\n\n\t\tconst btn_a = new UIInput(\"button\", ctrlStr[0]).addClass(\"btn-start\");\n\t\tbtn_a.dom.disabled = true;\n\t\tbtn_a.dom.onclick = () => {\n\n\t\t\tconst note = {\n\t\t\t\tdate: new Date(),\n\t\t\t\ttext: textBox.getValue(),\n\t\t\t\thref: selector.cfiRange,\n\t\t\t\tuuid: reader.uuid()\n\t\t\t};\n\n\t\t\treader.settings.annotations.push(note);\n\n\t\t\tthis.set(note);\n\n\t\t\ttextBox.setValue('');\n\t\t\tbtn_a.dom.disabled = true;\n\t\t\treturn false;\n\t\t};\n\n\t\tconst btn_c = new UIInput(\"button\", ctrlStr[1]).addClass(\"btn-end\");\n\t\tbtn_c.dom.disabled = true;\n\t\tbtn_c.dom.onclick = () => {\n\n\t\t\tthis.clearNotes();\n\t\t\treturn false;\n\t\t};\n\n\t\ttextRow.add(textBox);\n\t\tctrlRow.add([btn_a, btn_c]);\n\n\t\tthis.reader = reader;\n\t\tthis.notes = new UIList();\n\t\tthis.setId(\"annotations\");\n\t\tthis.add([textRow, ctrlRow]);\n\t\tthis.add(this.notes);\n\t\tthis.update = () => {\n\n\t\t\tbtn_c.dom.disabled = reader.settings.annotations.length === 0;\n\t\t};\n\n\t\tconst isSelected = () => {\n\n\t\t\treturn selector.range && selector.range.startOffset !== selector.range.endOffset;\n\t\t};\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tcfg.annotations.forEach((note) => {\n\n\t\t\t\tthis.set(note);\n\t\t\t});\n\t\t});\n\n\t\treader.on(\"selected\", (cfiRange, contents) => {\n\n\t\t\tselector.range = contents.range(cfiRange);\n\t\t\tselector.cfiRange = cfiRange;\n\n\t\t\tif (isSelected() && textBox.getValue().length > 0) {\n\t\t\t\tbtn_a.dom.disabled = false;\n\t\t\t} else {\n\t\t\t\tbtn_a.dom.disabled = true;\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"unselected\", () => {\n\n\t\t\tbtn_a.dom.disabled = true;\n\t\t});\n\t}\n\n\tset(note) {\n\n\t\tconst link = new UILink(\"#\" + note.href, note.text);\n\t\tconst btnr = new UISpan().setClass(\"btn-remove\");\n\t\tconst call = () => { };\n\n\t\tlink.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(note.href);\n\t\t\treturn false;\n\t\t};\n\n\t\tbtnr.dom.onclick = () => {\n\n\t\t\tthis.removeNote(note);\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.notes.add([link, btnr], \"note-\" + note.uuid);\n\t\tthis.reader.rendition.annotations.add(\n\t\t\t\"highlight\", note.href, {}, call, \"note-highlight\", {});\n\t\tthis.update();\n\t}\n\n\tremoveNote(note) {\n\n\t\tconst index = this.reader.settings.annotations.indexOf(note);\n\t\tif (index === -1)\n\t\t\treturn;\n\n\t\tthis.notes.remove(index);\n\t\tthis.reader.settings.annotations.splice(index, 1);\n\t\tthis.reader.rendition.annotations.remove(note.href, \"highlight\");\n\t\tthis.update();\n\t}\n\n\tclearNotes() {\n\n\t\tthis.notes.clear();\n\t\tthis.reader.settings.annotations = [];\n\t}\n}\n","import { UIPanel, UIRow, UIInput, UILink, UIList } from \"../ui.js\";\n\nexport class SearchPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tconst strings = reader.strings;\n\n\t\tlet searchQuery = undefined;\n\t\tconst searchBox = new UIInput(\"search\");\n\t\tsearchBox.dom.placeholder = strings.get(\"sidebar/search/placeholder\");\n\t\tsearchBox.dom.onsearch = () => {\n\n\t\t\tconst value = searchBox.getValue();\n\n\t\t\tif (value.length === 0) {\n\t\t\t\tthis.items.clear();\n\t\t\t} else if (searchQuery !== value) {\n\t\t\t\tthis.items.clear();\n\t\t\t\tthis.doSearch(value).then(results => {\n\n\t\t\t\t\tresults.forEach(data => {\n\t\t\t\t\t\tthis.set(data);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tsearchQuery = value;\n\t\t};\n\n\t\tconst ctrlRow = new UIRow();\n\t\tctrlRow.add(searchBox);\n\t\tsuper.add(ctrlRow);\n\n\t\tthis.setId(\"search\");\n\t\tthis.items = new UIList();\n\t\tthis.add(this.items);\n\t\tthis.reader = reader;\n\t\t//\n\t\t// improvement of the highlighting of keywords is required...\n\t\t//\n\t}\n\n\t/**\n\t * Searching the entire book\n\t * @param {*} q Query keyword\n\t * @returns The search result array.\n\t */\n\tasync doSearch(q) {\n\n\t\tconst book = this.reader.book;\n\t\tconst results = await Promise.all(\n\t\t\tbook.spine.spineItems.map(item => item.load(book.load.bind(book))\n\t\t\t\t.then(item.find.bind(item, q)).finally(item.unload.bind(item))));\n\t\treturn await Promise.resolve([].concat.apply([], results));\n\t}\n\n\tset(data) {\n\n\t\tconst link = new UILink(\"#\" + data.cfi, data.excerpt);\n\t\tlink.dom.onclick = () => {\n\n\t\t\tthis.reader.rendition.display(data.cfi);\n\t\t\treturn false;\n\t\t};\n\t\tthis.items.add(link);\n\t}\n}\n","import { UIPanel, UIRow, UISelect, UIInput, UILabel, UINumber } from \"../ui.js\";\n\nexport class SettingsPanel extends UIPanel {\n\n\tconstructor(reader) {\n\n\t\tsuper();\n\t\tsuper.setId(\"settings\");\n\n\t\tconst strings = reader.strings;\n\t\tconst keys = [\n\t\t\t\"sidebar/settings/language\",\n\t\t\t\"sidebar/settings/fontsize\",\n\t\t\t\"sidebar/settings/layout\",\n\t\t\t\"sidebar/settings/spread\",\n\t\t\t\"sidebar/settings/spread/pagewidth\"\n\t\t];\n\n\t\tconst languageLabel = new UILabel(strings.get(keys[0]), \"language-ui\");\n\t\tconst languageRow = new UIRow();\n\t\tconst language = new UISelect().setOptions({\n\t\t\ten: \"English\",\n\t\t\tfr: \"French\",\n\t\t\tja: \"Japanese\",\n\t\t\tru: \"Russian\"\n\t\t});\n\t\tlanguage.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"languagechanged\", e.target.value);\n\t\t};\n\t\tlanguage.setId(\"language-ui\");\n\n\t\tlanguageRow.add(languageLabel);\n\t\tlanguageRow.add(language);\n\n\t\tconst fontSizeLabel = new UILabel(strings.get(keys[1]), \"fontsize\");\n\t\tconst fontSizeRow = new UIRow();\n\t\tconst fontSize = new UINumber(100, 1);\n\t\tfontSize.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"styleschanged\", {\n\t\t\t\tfontSize: parseInt(e.target.value)\n\t\t\t});\n\t\t};\n\t\tfontSize.setId(\"fontsize\")\n\n\t\tfontSizeRow.add(fontSizeLabel);\n\t\tfontSizeRow.add(fontSize);\n\n\t\t//-- layout configure --//\n\n\t\tconst layoutLabel = new UILabel(strings.get(keys[2]), \"layout\");\n\t\tconst layoutRow = new UIRow();\n\t\tconst layout = new UISelect().setOptions({\n\t\t\tpaginated: \"Paginated\",\n\t\t\tscrolled: \"Scrolled\"\n\t\t});\n\t\tlayout.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"flowchanged\", e.target.value);\n\n\t\t\tif (e.target.value === \"scrolled\") {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: \"none\",\n\t\t\t\t\tmin: undefined\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\t\tmod: undefined,\n\t\t\t\t\tmin: undefined\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tlayout.setId(\"layout\");\n\n\t\tlayoutRow.add(layoutLabel);\n\t\tlayoutRow.add(layout);\n\n\t\t//-- spdead configure --//\n\n\t\tconst spreadLabel = new UILabel(strings.get(keys[3]), \"spread\");\n\t\tconst spreadRow = new UIRow();\n\t\tconst spread = new UISelect().setOptions({\n\t\t\tnone: \"None\",\n\t\t\tauto: \"Auto\"\n\t\t});\n\t\tspread.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: e.target.value,\n\t\t\t\tmin: undefined\n\t\t\t});\n\t\t};\n\t\tspread.setId(\"spread\");\n\n\t\tspreadRow.add(spreadLabel);\n\t\tspreadRow.add(spread);\n\n\t\tconst minSpreadWidthLabel = new UILabel(strings.get(keys[4]), \"min-spread-width\");\n\t\tconst minSpreadWidthRow = new UIRow();\n\t\tconst minSpreadWidth = new UINumber(800, 1);\n\t\tminSpreadWidth.dom.onchange = (e) => {\n\n\t\t\treader.emit(\"spreadchanged\", {\n\t\t\t\tmod: undefined,\n\t\t\t\tmin: parseInt(e.target.value)\n\t\t\t});\n\t\t};\n\t\tminSpreadWidth.setId(\"min-spread-width\");\n\n\t\tminSpreadWidthRow.add(minSpreadWidthLabel);\n\t\tminSpreadWidthRow.add(minSpreadWidth);\n\n\t\t//-- pagination --//\n\n\t\tconst paginationStr = strings.get(\"sidebar/settings/pagination\");\n\t\tconst paginationRow = new UIRow();\n\t\tconst pagination = new UIInput(\"checkbox\", false, paginationStr[1]);\n\t\tpagination.setId(\"pagination\");\n\t\tpagination.dom.onclick = (e) => {\n\n\t\t\t// not implemented\n\t\t};\n\n\t\tpaginationRow.add(new UILabel(paginationStr[0], \"pagination\"));\n\t\tpaginationRow.add(pagination);\n\n\t\tsuper.add([\n\t\t\tlanguageRow,\n\t\t\tfontSizeRow,\n\t\t\tlayoutRow,\n\t\t\tspreadRow,\n\t\t\tminSpreadWidthRow,\n\t\t\t//paginationRow\n\t\t]);\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tlanguage.setValue(cfg.language);\n\t\t\tfontSize.setValue(cfg.styles.fontSize);\n\t\t\tlayout.setValue(cfg.flow);\n\t\t\tspread.setValue(cfg.spread.mod);\n\t\t\tminSpreadWidth.setValue(cfg.spread.min);\n\t\t});\n\n\t\treader.on(\"layout\", (props) => {\n\n\t\t\tif (props.flow === \"scrolled\") {\n\t\t\t\tspread.dom.disabled = true;\n\t\t\t\tspread.setValue(\"none\");\n\t\t\t} else {\n\t\t\t\tspread.dom.disabled = false;\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"languagechanged\", (value) => {\n\n\t\t\tlanguageLabel.dom.textContent = strings.get(keys[0]);\n\t\t\tfontSizeLabel.dom.textContent = strings.get(keys[1]);\n\t\t\tlayoutLabel.dom.textContent = strings.get(keys[2]);\n\t\t\tspreadLabel.dom.textContent = strings.get(keys[3]);\n\t\t\tminSpreadWidthLabel.dom.textContent = strings.get(keys[4]);\n\t\t});\n\t}\n}\n","import { UITabbedPanel } from './ui.js';\nimport { TocPanel } from './sidebar/toc.js';\nimport { BookmarksPanel } from './sidebar/bookmarks.js';\nimport { AnnotationsPanel } from './sidebar/annotations.js';\nimport { SearchPanel } from './sidebar/search.js';\nimport { SettingsPanel } from './sidebar/settings.js';\n\nexport class Sidebar {\n\n\tconstructor(reader) {\n\n\t\tconst strings = reader.strings;\n\t\tconst tabs = [\n\t\t\tstrings.get('sidebar/contents'),\n\t\t\tstrings.get('sidebar/bookmarks'),\n\t\t\tstrings.get('sidebar/annotations'),\n\t\t\tstrings.get('sidebar/search'),\n\t\t\tstrings.get('sidebar/settings')\n\t\t];\n\n\t\tconst container = new UITabbedPanel('vertical').setId('sidebar');\n\n\t\tcontainer.addTab('tab-t', tabs[0], new TocPanel(reader));\n\t\tcontainer.addTab('tab-b', tabs[1], new BookmarksPanel(reader));\n\t\tcontainer.addTab('tab-n', tabs[2], new AnnotationsPanel(reader));\n\t\tcontainer.addTab('tab-s', tabs[3], new SearchPanel(reader));\n\t\tcontainer.addTab('tab-c', tabs[4], new SettingsPanel(reader));\n\t\tcontainer.select('tab-t');\n\n\t\tdocument.body.appendChild(container.dom);\n\t}\n}\n","import { UIDiv, UILabel } from \"./ui.js\";\n\nexport class Content {\n\n\tconstructor(reader) {\n\n\t\tconst container = new UIDiv().setId(\"content\");\n\t\tcontainer.dom.ontransitionend = (e) => {\n\n\t\t\treader.emit(\"sidebarreflow\");\n\t\t\te.preventDefault();\n\t\t};\n\n\t\tconst prev = new UIDiv().setId(\"prev\").setClass(\"arrow\");\n\t\tprev.dom.onclick = (e) => {\n\n\t\t\treader.emit(\"prev\");\n\t\t\te.preventDefault();\n\t\t};\n\t\tprev.add(new UILabel(\"<\"));\n\n\t\tconst next = new UIDiv().setId(\"next\").setClass(\"arrow\");\n\t\tnext.dom.onclick = (e) => {\n\n\t\t\treader.emit(\"next\");\n\t\t\te.preventDefault();\n\t\t};\n\t\tnext.add(new UILabel(\">\"));\n\n\t\tconst viewer = new UIDiv().setId(\"viewer\");\n\t\tconst divider = new UIDiv().setId(\"divider\");\n\t\tconst loader = new UIDiv().setId(\"loader\");\n\n\t\tcontainer.add([prev, viewer, next, divider, loader]);\n\t\tdocument.body.appendChild(container.dom);\n\n\t\t//-- events --//\n\n\t\treader.on(\"bookready\", (cfg) => {\n\n\t\t\tloader.dom.style.display = \"block\";\n\t\t});\n\n\t\treader.on(\"bookloaded\", () => {\n\n\t\t\tloader.dom.style.display = \"none\";\n\t\t});\n\n\t\treader.on(\"sidebaropener\", (value) => {\n\n\t\t\tif (value) {\n\t\t\t\tcontainer.addClass(\"closed\");\n\t\t\t} else {\n\t\t\t\tcontainer.removeClass(\"closed\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"layout\", (props) => {\n\n\t\t\tif (props.spread && props.width > props.spreadWidth) {\n\t\t\t\tdivider.dom.style.display = \"block\";\n\t\t\t} else {\n\t\t\t\tdivider.dom.style.display = \"none\";\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"relocated\", (location) => {\n\n\t\t\tif (location.atStart) {\n\t\t\t\tprev.addClass(\"disabled\");\n\t\t\t} else {\n\t\t\t\tprev.removeClass(\"disabled\");\n\t\t\t}\n\n\t\t\tif (location.atEnd) {\n\t\t\t\tnext.addClass(\"disabled\");\n\t\t\t} else {\n\t\t\t\tnext.removeClass(\"disabled\");\n\t\t\t}\n\t\t});\n\n\t\treader.on(\"prev\", () => {\n\n\t\t\tprev.addClass(\"active\");\n\t\t\tsetTimeout(() => { prev.removeClass(\"active\"); }, 100);\n\t\t});\n\n\t\treader.on(\"next\", () => {\n\n\t\t\tnext.addClass(\"active\");\n\t\t\tsetTimeout(() => { next.removeClass(\"active\"); }, 100);\n\t\t});\n\n\t\treader.on(\"viewercleanup\", () => {\n\n\t\t\tviewer.clear();\n\t\t});\n\t}\n}\n","export class Strings {\n\n\tconstructor(reader) {\n\n\t\tthis.language = reader.settings.language || \"en\";\n\t\tthis.values = {\n\t\t\ten: {\n\t\t\t\t\"toolbar/opener\": \"Sidebar\",\n\t\t\t\t\"toolbar/openbook\": \"Open book\",\n\t\t\t\t\"toolbar/openbook/error\": \"Your browser does not support the required features.\\nPlease use a modern browser such as Google Chrome, or Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Add this page to bookmarks\",\n\t\t\t\t\"toolbar/fullsceen\": \"Fullscreen\",\n\n\t\t\t\t\"sidebar/contents\": \"Contents\",\n\t\t\t\t\"sidebar/bookmarks\": \"Bookmarks\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Add\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Remove\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Clear\",\n\t\t\t\t\"sidebar/annotations\": \"Annotations\",\n\t\t\t\t\"sidebar/annotations/add\": \"Add\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Clear\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Anchor\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Cancel\",\n\t\t\t\t\"sidebar/search\": \"Search\",\n\t\t\t\t\"sidebar/search/placeholder\": \"Search\",\n\t\t\t\t\"sidebar/settings\": \"Settings\",\n\t\t\t\t\"sidebar/settings/language\": \"Language\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"Font size (%)\",\n\t\t\t\t\"sidebar/settings/layout\": \"Layout\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Pagination\", \"Generate pagination\"],\n\t\t\t\t\"sidebar/settings/spread\": \"Spread\",\n\t\t\t\t\"sidebar/settings/spread/pagewidth\": \"Page width\"\n\t\t\t},\n\t\t\tfr: {\n\t\t\t\t\"toolbar/opener\": \"Barre latérale\",\n\t\t\t\t\"toolbar/openbook\": \"Ouvrir un livre local\",\n\t\t\t\t\"toolbar/openbook/error\": \"Votre navigateur ne prend pas en charge les fonctions nécessaires.\\nVeuillez utiliser un navigateur moderne tel que Google Chrome ou Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Insérer un marque page ici\",\n\t\t\t\t\"toolbar/fullsceen\": \"Plein écran\",\n\n\t\t\t\t\"sidebar/contents\": \"Sommaire\",\n\t\t\t\t\"sidebar/bookmarks\": \"Marque-pages\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Ajouter\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Retirer\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Tout enlever\",\n\t\t\t\t\"sidebar/annotations\": \"Annotations\",\n\t\t\t\t\"sidebar/annotations/add\": \"Ajouter\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Tout enlever\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Ancre\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Annuler\",\n\t\t\t\t\"sidebar/search\": \"Rechercher\",\n\t\t\t\t\"sidebar/search/placeholder\": \"rechercher\",\n\t\t\t\t\"sidebar/settings\": \"Réglages\",\n\t\t\t\t\"sidebar/settings/language\": \"Langue\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"???\",\n\t\t\t\t\"sidebar/settings/layout\": \"???\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Pagination\", \"Établir une pagination\"],\n\t\t\t\t\"sidebar/settings/spread\": \"???\",\n\t\t\t\t\"sidebar/settings/spread/pagewidth\": \"???\"\n\t\t\t},\n\t\t\tja: {\n\t\t\t\t\"toolbar/opener\": \"サイドバー\",\n\t\t\t\t\"toolbar/openbook\": \"本を開く\",\n\t\t\t\t\"toolbar/openbook/error\": \"ご利用のブラウザは必要な機能をサポートしていません。\\nGoogle Chrome、Mozilla Firefox、その他のモダンなブラウザでご利用ください。\",\n\t\t\t\t\"toolbar/bookmark\": \"このページに栞を設定する\",\n\t\t\t\t\"toolbar/fullsceen\": \"フルスクリーン\",\n\n\t\t\t\t\"sidebar/contents\": \"目次\",\n\t\t\t\t\"sidebar/bookmarks\": \"栞\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"追加\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"削除\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"クリア\",\n\t\t\t\t\"sidebar/annotations\": \"注釈\",\n\t\t\t\t\"sidebar/annotations/add\": \"追加\",\n\t\t\t\t\"sidebar/annotations/clear\": \"クリア\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"アンカー\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"キャンセル\",\n\t\t\t\t\"sidebar/search\": \"検索\",\n\t\t\t\t\"sidebar/search/placeholder\": \"検索\",\n\t\t\t\t\"sidebar/settings\": \"設定\",\n\t\t\t\t\"sidebar/settings/language\": \"表示言語\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"???\",\n\t\t\t\t\"sidebar/settings/layout\": \"???\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"ページネーション\", \"ページネーションを生成します。\"],\n\t\t\t\t\"sidebar/settings/spread\": \"???\",\n\t\t\t\t\"sidebar/settings/spread/pagewidth\": \"???\"\n\t\t\t},\n\t\t\tru: {\n\t\t\t\t\"toolbar/opener\": \"Боковая панель\",\n\t\t\t\t\"toolbar/openbook\": \"Открыть книгу\",\n\t\t\t\t\"toolbar/openbook/error\": \"Ваш браузер не поддерживает необходимые функции.\\nПожалуйста, используйте современный браузер, такой как Google Chrome или Mozilla Firefox.\",\n\t\t\t\t\"toolbar/bookmark\": \"Добавить эту страницу в закладки\",\n\t\t\t\t\"toolbar/fullsceen\": \"Полноэкранный режим\",\n\n\t\t\t\t\"sidebar/contents\": \"Содержание\",\n\t\t\t\t\"sidebar/bookmarks\": \"Закладки\",\n\t\t\t\t\"sidebar/bookmarks/add\": \"Добавить\",\n\t\t\t\t\"sidebar/bookmarks/remove\": \"Удалить\",\n\t\t\t\t\"sidebar/bookmarks/clear\": \"Очистить\",\n\t\t\t\t\"sidebar/annotations\": \"Аннотации\",\n\t\t\t\t\"sidebar/annotations/add\": \"Добавить\",\n\t\t\t\t\"sidebar/annotations/clear\": \"Очистить\",\n\t\t\t\t\"sidebar/annotations/anchor\": \"Метка\",\n\t\t\t\t\"sidebar/annotations/cancel\": \"Отмена\",\n\t\t\t\t\"sidebar/search\": \"Поиск\",\n\t\t\t\t\"sidebar/search/placeholder\": \"Поиск\",\n\t\t\t\t\"sidebar/settings\": \"Настройки\",\n\t\t\t\t\"sidebar/settings/language\": \"Язык\",\n\t\t\t\t\"sidebar/settings/fontsize\": \"Размер шрифта\",\n\t\t\t\t\"sidebar/settings/layout\": \"Макет\",\n\t\t\t\t\"sidebar/settings/pagination\": [\"Нумерация страниц\", \"Генерировать нумерацию страниц\"],\n\t\t\t\t\"sidebar/settings/spread\": \"Разворот\",\n\t\t\t\t\"sidebar/settings/spread/pagewidth\": \"Ширина страницы\"\n\t\t\t}\n\t\t};\n\n\t\treader.on(\"languagechanged\", (value) => {\n\t\t\tthis.language = value;\n\t\t});\n\t}\n\n\tget(key) { return this.values[this.language][key] || \"???\"; }\n}\n","import EventEmitter from \"event-emitter\";\n\nimport { Toolbar } from \"./toolbar.js\";\nimport { Sidebar } from \"./sidebar.js\";\nimport { Content } from \"./content.js\";\nimport { Strings } from \"./strings.js\";\n\nexport class Reader {\n\n\tconstructor(bookPath, _options) {\n\n\t\tthis.settings = undefined;\n\t\tthis.cfgInit(bookPath, _options);\n\n\t\tthis.strings = new Strings(this);\n\t\tthis.toolbar = new Toolbar(this);\n\t\tthis.sidebar = new Sidebar(this);\n\t\tthis.content = new Content(this);\n\n\t\tthis.book = undefined;\n\t\tthis.rendition = undefined;\n\t\tthis.displayed = undefined;\n\n\t\tthis.init();\n\n\t\twindow.onbeforeunload = this.unload.bind(this);\n\t\twindow.onhashchange = this.hashChanged.bind(this);\n\t\twindow.onkeydown = this.keyboardHandler.bind(this);\n\t\twindow.onwheel = (e) => {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Initialize book.\n\t * @param {*} bookPath\n\t * @param {*} _options\n\t */\n\tinit(bookPath, _options) {\n\n\t\tthis.emit(\"viewercleanup\");\n\n\t\tif (arguments.length > 0) {\n\n\t\t\tthis.cfgInit(bookPath, _options);\n\t\t}\n\n\t\tthis.book = ePub(this.settings.bookPath);\n\t\tthis.rendition = this.book.renderTo(\"viewer\", {\n\t\t\tflow: this.settings.flow,\n\t\t\tspread: this.settings.spread.mod,\n\t\t\tminSpreadWidth: this.settings.spread.min,\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\"\n\t\t});\n\n\t\tconst cfi = this.settings.previousLocationCfi;\n\t\tif (cfi) {\n\t\t\tthis.displayed = this.rendition.display(cfi);\n\t\t} else {\n\t\t\tthis.displayed = this.rendition.display();\n\t\t}\n\n\t\tthis.displayed.then((renderer) => {\n\t\t\tthis.emit(\"renderered\", renderer);\n\t\t});\n\n\t\tthis.book.ready.then(function () {\n\t\t\tthis.emit(\"bookready\", this.settings);\n\t\t}.bind(this)).then(function () {\n\t\t\tthis.emit(\"bookloaded\");\n\t\t}.bind(this));\n\n\t\tthis.book.loaded.metadata.then((meta) => {\n\t\t\tthis.emit(\"metadata\", meta);\n\t\t});\n\n\t\tthis.book.loaded.navigation.then((toc) => {\n\t\t\tthis.emit(\"navigation\", toc);\n\t\t});\n\n\t\tthis.rendition.on(\"click\", (e) => {\n\t\t\tconst selection = e.view.document.getSelection();\n\t\t\tconst range = selection.getRangeAt(0);\n\t\t\tif (range.startOffset === range.endOffset) {\n\t\t\t\tthis.emit(\"unselected\");\n\t\t\t}\n\t\t});\n\n\t\tthis.rendition.on(\"layout\", (props) => {\n\t\t\tthis.emit(\"layout\", props);\n\t\t});\n\n\t\tthis.rendition.on(\"selected\", (cfiRange, contents) => {\n\t\t\tthis.setLocation(cfiRange);\n\t\t\tthis.emit(\"selected\", cfiRange, contents);\n\t\t});\n\n\t\tthis.rendition.on(\"relocated\", (location) => {\n\t\t\tthis.setLocation(location.start.cfi);\n\t\t\tthis.emit(\"relocated\", location);\n\t\t});\n\n\t\tthis.on(\"prev\", () => {\n\t\t\tif (this.book.package.metadata.direction === 'rtl') {\n\t\t\t\tthis.rendition.next();\n\t\t\t} else {\n\t\t\t\tthis.rendition.prev();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(\"next\", () => {\n\t\t\tif (this.book.package.metadata.direction === 'rtl') {\n\t\t\t\tthis.rendition.prev();\n\t\t\t} else {\n\t\t\t\tthis.rendition.next();\n\t\t\t}\n\t\t});\n\n\t\tthis.on(\"sidebarreflow\", () => {\n\t\t\t// no implementation sidebarReflow setting\n\t\t\t//this.rendition.resize();\n\t\t});\n\n\t\tthis.on(\"tocselected\", (chapter) => {\n\t\t\tthis.settings.sectionId = chapter.id;\n\t\t\tthis.rendition.display(chapter.href);\n\t\t});\n\n\t\tthis.on(\"languagechanged\", (value) => {\n\t\t\tthis.settings.language = value;\n\t\t});\n\n\t\tthis.on(\"flowchanged\", (value) => {\n\t\t\tthis.settings.flow = value;\n\t\t\tthis.rendition.flow(value);\n\t\t});\n\t\t\n\t\tthis.on(\"spreadchanged\", (value) => {\n\t\t\tconst mod = value.mod || this.settings.spread.mod;\n\t\t\tconst min = value.min || this.settings.spread.min;\n\t\t\tthis.settings.spread.mod = mod;\n\t\t\tthis.settings.spread.min = min;\n\t\t\tthis.rendition.spread(mod, min);\n\t\t});\n\n\t\tthis.on(\"styleschanged\", (value) => {\n\t\t\tconst fontSize = value.fontSize;\n\t\t\tthis.settings.styles.fontSize = fontSize;\n\t\t\tthis.rendition.themes.fontSize(fontSize + \"%\");\n\t\t});\n\t}\n\n\t/* ------------------------------- Common ------------------------------- */\n\n\tdefaults(obj) {\n\n\t\tfor (let i = 1, length = arguments.length; i < length; i++) {\n\t\t\tconst source = arguments[i];\n\t\t\tfor (let prop in source) {\n\t\t\t\tif (obj[prop] === void 0)\n\t\t\t\t\tobj[prop] = source[prop];\n\t\t\t}\n\t\t}\n\t\treturn obj;\n\t}\n\n\tuuid() {\n\n\t\tlet d = new Date().getTime();\n\t\tconst uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n\t\t\tlet r = (d + Math.random() * 16) % 16 | 0;\n\t\t\td = Math.floor(d / 16);\n\t\t\treturn (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n\t\t});\n\t\treturn uuid;\n\t}\n\n\t/* ------------------------------ Bookmarks ----------------------------- */\n\n\t/**\n\t * Verifying the current page in bookmarks.\n\t * @param {*} cfi\n\t * @returns The index of the bookmark if it exists, or -1 otherwise.\n\t */\n\tisBookmarked(cfi) {\n\n\t\treturn this.settings.bookmarks.indexOf(cfi);\n\t}\n\n\t/* ----------------------------- Annotations ---------------------------- */\n\n\tisAnnotated(note) {\n\n\t\treturn this.settings.annotations.indexOf(note);\n\t}\n\n\t/* ------------------------------ Settings ------------------------------ */\n\n\t/**\n\t * Initialize book settings.\n\t * @param {*} bookPath\n\t * @param {*} _options\n\t */\n\tcfgInit(bookPath, _options) {\n\n\t\tthis.entryKey = md5(bookPath).toString();\n\t\tthis.settings = this.defaults(_options || {}, {\n\t\t\tbookPath: bookPath,\n\t\t\tflow: undefined,\n\t\t\trestore: false,\n\t\t\thistory: true,\n\t\t\treload: false, // ??\n\t\t\tbookmarks: undefined,\n\t\t\tannotations: undefined,\n\t\t\tcontained: undefined,\n\t\t\tsectionId: undefined,\n\t\t\tspread: undefined,\n\t\t\tstyles: undefined,\n\t\t\tpagination: false, // ??\n\t\t\tlanguage: undefined\n\t\t});\n\n\t\tif (this.settings.restore && this.isSaved()) {\n\t\t\tthis.applySavedSettings();\n\t\t}\n\n\t\tif (this.settings.bookmarks === undefined) {\n\t\t\tthis.settings.bookmarks = [];\n\t\t}\n\n\t\tif (this.settings.annotations === undefined) {\n\t\t\tthis.settings.annotations = [];\n\t\t}\n\n\t\tif (this.settings.flow === undefined) {\n\t\t\tthis.settings.flow = \"paginated\";\n\t\t}\n\n\t\tif (this.settings.spread === undefined) {\n\t\t\tthis.settings.spread = {\n\t\t\t\tmod: \"auto\",\n\t\t\t\tmin: 800\n\t\t\t};\n\t\t}\n\n\t\tif (this.settings.styles === undefined) {\n\t\t\tthis.settings.styles = {\n\t\t\t\tfontSize: 100\n\t\t\t};\n\t\t}\n\n\t\tif (this.settings.language === undefined) {\n\t\t\tthis.settings.language = \"en\";\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the book setting can be retrieved from localStorage.\n\t * @returns true if the book key exists, or false otherwise.\n\t */\n\tisSaved() {\n\n\t\tif (!localStorage)\n\t\t\treturn false;\n\n\t\treturn localStorage.getItem(this.entryKey) !== null;\n\t}\n\n\t/**\n\t * Removing the current book settings from local storage.\n\t * @returns true if the book settings were deleted successfully, or false\n\t * otherwise.\n\t */\n\tremoveSavedSettings() {\n\n\t\tif (!this.isSaved())\n\t\t\treturn false;\n\n\t\tlocalStorage.removeItem(this.entryKey);\n\t\treturn true;\n\t}\n\n\tapplySavedSettings() {\n\n\t\tif (!localStorage)\n\t\t\treturn false;\n\n\t\tlet stored;\n\t\ttry {\n\t\t\tstored = JSON.parse(localStorage.getItem(this.entryKey));\n\t\t} catch (e) { // parsing error of localStorage\n\t\t\tconsole.exception(e);\n\t\t}\n\n\t\tif (stored) {\n\t\t\t// Merge spread\n\t\t\tif (stored.spread) {\n\t\t\t\tthis.settings.spread = this.defaults(this.settings.spread || {}, \n\t\t\t\t\tstored.spread);\n\t\t\t}\n\t\t\t// Merge styles\n\t\t\tif (stored.styles) {\n\t\t\t\tthis.settings.styles = this.defaults(this.settings.styles || {},\n\t\t\t\t\tstored.styles);\n\t\t\t}\n\t\t\t// Merge the rest\n\t\t\tthis.settings = this.defaults(this.settings, stored);\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Saving the current book settings in local storage.\n\t * @returns\n\t */\n\tsaveSettings() {\n\n\t\tthis.settings.previousLocationCfi = this.rendition.location.start.cfi;\n\t\tlocalStorage.setItem(this.entryKey, JSON.stringify(this.settings));\n\t}\n\n\tsetLocation(cfi) {\n\n\t\tconst baseUrl = this.book.archived ? undefined : this.book.url;\n\t\tconst url = new URL(window.location, baseUrl);\n\t\turl.hash = \"#\" + cfi;\n\n\t\t// Update the History Location\n\t\tif (this.settings.history && window.location.hash !== url.hash) {\n\t\t\t// Add CFI fragment to the history\n\t\t\twindow.history.pushState({}, \"\", url);\n\t\t\tthis.currentLocationCfi = cfi;\n\t\t}\n\t}\n\n\t//-- event handlers --//\n\n\tunload() {\n\n\t\tif (this.settings.restore && localStorage) {\n\t\t\tthis.saveSettings();\n\t\t}\n\t}\n\n\thashChanged() {\n\n\t\tconst hash = window.location.hash.slice(1);\n\t\tthis.rendition.display(hash);\n\t}\n\n\tkeyboardHandler(e) {\n\n\t\tconst MOD = (e.ctrlKey || e.metaKey);\n\n\t\tif (MOD) {\n\n\t\t\tconst step = 2;\n\t\t\tlet value = this.settings.styles.fontSize;\n\n\t\t\tswitch (e.key) {\n\n\t\t\t\tcase '=':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue += step;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t\tcase '-':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue -= step;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t\tcase '0':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvalue = 100;\n\t\t\t\t\tthis.emit(\"styleschanged\", { fontSize: value });\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\tthis.emit('prev');\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\tthis.emit('next');\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nEventEmitter(Reader.prototype);\n","export class Storage {\n\n\tconstructor() {\n\n\t\tthis.name = 'epubjs-reader';\n\t\tthis.version = 1.0;\n\t\tthis.database;\n\t\tthis.indexedDB = window.indexedDB ||\n\t\t\twindow.webkitIndexedDB ||\n\t\t\twindow.mozIndexedDB ||\n\t\t\twindow.OIndexedDB ||\n\t\t\twindow.msIndexedDB;\n\n\t\tif (this.indexedDB === undefined) {\n\n\t\t\talert('The IndexedDB API not available in your browser.');\n\t\t}\n\t}\n\n\tinit(callback) {\n\n\t\tif (this.indexedDB === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst scope = this;\n\t\tconst request = indexedDB.open(this.name, this.version);\n\t\trequest.onupgradeneeded = function (event) {\n\n\t\t\tconst db = event.target.result;\n\t\t\tif (db.objectStoreNames.contains('entries') === false) {\n\n\t\t\t\tdb.createObjectStore(\"entries\");\n\t\t\t}\n\t\t};\n\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tscope.database = event.target.result;\n\t\t\tscope.database.onerror = function (event) {\n\n\t\t\t\tconsole.error('IndexedDB', event);\n\t\t\t};\n\t\t\tcallback();\n\t\t}\n\n\t\trequest.onerror = function (event) {\n\n\t\t\tconsole.error('IndexedDB', event);\n\t\t};\n\t}\n\n\tget(callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.get(0);\n\t\trequest.onsuccess = function (event) {\n\n\t\t\tcallback(event.target.result);\n\t\t\tconsole.log('storage.get');\n\t\t};\n\t}\n\n\tset(data, callback) {\n\n\t\tif (this.database === undefined) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.put(data, 0);\n\t\trequest.onsuccess = function () {\n\n\t\t\tcallback();\n\t\t\tconsole.log('storage.set');\n\t\t};\n\t}\n\n\tclear() {\n\n\t\tif (this.database === undefined)\n\t\t\treturn;\n\n\t\tconst transaction = this.database.transaction(['entries'], 'readwrite');\n\t\tconst objectStore = transaction.objectStore('entries');\n\t\tconst request = objectStore.clear();\n\t\trequest.onsuccess = function () {\n\n\t\t\tconsole.log('storage.clear');\n\t\t};\n\t}\n}\n","import { Reader } from './reader.js';\nimport { Storage } from './storage.js';\n\n\"use strict\";\n\nwindow.ResizeObserver = undefined;\nwindow.onload = function () {\n\n\tconst storage = new Storage();\n\tconst url = new URL(window.location);\n\tconst path = url.search.length > 0\n\t\t? url.searchParams.get(\"bookPath\")\n\t\t: \"https://s3.amazonaws.com/moby-dick/\";\n\n\tstorage.init(function () {\n\n\t\tstorage.get(function (data) {\n\n\t\t\tif (data !== undefined && url.search.length === 0) {\n\n\t\t\t\twindow.reader = new Reader(data, { restore: true });\n\n\t\t\t} else {\n\n\t\t\t\twindow.reader = new Reader(path, { restore: true });\n\t\t\t}\n\t\t});\n\t});\n\n\twindow.storage = storage;\n};\n"],"names":["isValue","isPlainFunction","assign","normalizeOpts","contains","module","exports","dscr","value","c","e","w","options","desc","arguments","length","call","configurable","enumerable","writable","gs","get","set","undefined","Object","obj","foo","bar","trzy","keys","max","Math","dest","src","error","i","key","forEach","_undefined","val","object","Array","prototype","create","opts1","result","process","fn","TypeError","String","str","indexOf","searchString","this","on","once","off","emit","methods","descriptors","base","d","callable","apply","Function","defineProperty","defineProperties","hasOwnProperty","descriptor","type","listener","self","__eeOnceListener__","data","__ee__","push","listeners","candidate","splice","l","args","slice","o","isPrototype","possibleTypes","isFunction","classRe","functionToString","toString","test","isObject","constructor","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","a","definition","prop","ERROR_MSG","UIElement","tag","dom","document","createElement","add","argument","appendChild","isArray","j","element","console","remove","removeChild","Number","isInteger","childNodes","clear","children","lastChild","setId","id","getId","setClass","name","className","addClass","classList","removeClass","setStyle","style","setTextContent","text","textContent","getBoundingClientRect","UISpan","super","UIDiv","UIRow","UIPanel","UILabel","htmlFor","UILink","href","setHref","url","UIText","getValue","setValue","UITextArea","spellcheck","onkeydown","stopPropagation","cursor","selectionStart","substring","selectionEnd","preventDefault","UISelect","setMultiple","boolean","multiple","setOptions","selected","option","UIInput","title","setTitle","getName","setName","getTitle","getType","setType","UINumber","step","min","precision","onchange","setPrecision","setRange","setStep","parseFloat","toFixed","UITabbedPanel","align","tabs","panels","selector","tabsDiv","panelsDiv","addTab","label","items","tab","UITab","panel","select","transformSelector","display","size","rect","width","transform","height","parent","button","onclick","UIList","list","item","listItem","UITreeView","UITreeViewItem","link","toggle","expander","expanded","setItem","subItem","collaps","expand","getElementsByTagName","unselect","removeAttribute","MetadataPanel","reader","creator","separator","meta","Toolbar","strings","container","start","opener","isOpen","onload","storage","target","unload","init","restore","URL","window","location","origin","history","pushState","onerror","end","openbook","accept","files","FileReader","fr","readAsArrayBuffer","alert","bookmark","cfi","locationCfi","isBookmarked","fullscreen","fullscreenEnabled","toggleFullScreen","onfullscreenchange","screen","clientWidth","h","clientHeight","body","activeElement","blur","fullscreenElement","documentElement","requestFullscreen","exitFullscreen","TocPanel","toc","generateToc","chapter","settings","sectionId","subitems","BookmarksPanel","ctrlRow","ctrlStr","btn_a","btn_r","btn_c","clearBookmarks","bookmarks","update","disabled","cfg","setBookmark","appendBookmark","removeBookmark","index","book","spineItem","spine","navItem","navigation","itemId","idref","rendition","AnnotationsPanel","textBox","oninput","isSelected","range","cfiRange","textRow","note","date","Date","uuid","annotations","clearNotes","notes","startOffset","endOffset","contents","btnr","removeNote","SearchPanel","searchQuery","searchBox","placeholder","onsearch","doSearch","then","results","q","Promise","all","spineItems","map","load","bind","find","finally","resolve","concat","excerpt","SettingsPanel","languageLabel","languageRow","language","en","ja","ru","fontSizeLabel","fontSizeRow","fontSize","parseInt","layoutLabel","layoutRow","layout","paginated","scrolled","mod","spreadLabel","spreadRow","spread","none","auto","minSpreadWidthLabel","minSpreadWidthRow","minSpreadWidth","paginationStr","paginationRow","pagination","styles","flow","props","Sidebar","Content","ontransitionend","prev","next","viewer","divider","loader","spreadWidth","atStart","atEnd","setTimeout","Strings","values","Reader","bookPath","_options","cfgInit","toolbar","sidebar","content","displayed","onbeforeunload","onhashchange","hashChanged","keyboardHandler","onwheel","ctrlKey","ePub","renderTo","previousLocationCfi","renderer","ready","loaded","metadata","view","getSelection","getRangeAt","setLocation","package","direction","themes","defaults","source","getTime","replace","r","random","floor","isAnnotated","entryKey","md5","reload","contained","isSaved","applySavedSettings","localStorage","getItem","removeSavedSettings","removeItem","stored","JSON","parse","exception","saveSettings","stringify","baseUrl","archived","hash","currentLocationCfi","metaKey","Storage","version","database","indexedDB","webkitIndexedDB","mozIndexedDB","OIndexedDB","msIndexedDB","callback","scope","request","open","onupgradeneeded","event","db","objectStoreNames","createObjectStore","onsuccess","transaction","objectStore","log","put","ResizeObserver","path","search","searchParams"],"sourceRoot":""}